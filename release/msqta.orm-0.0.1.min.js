(function(e){var t="MSQTA-ORM!",n="__msqta__",r="databases",i="name",s="dump",o=o||{};o.rr=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,o.ss=e.IDBTransaction||e.webkitIDBTransaction||e.msIDBTransaction;if(!o.ss.READ_WRITE||!o.ss.READ_ONLY)o.ss.READ_WRITE="readwrite",o.ss.READ_ONLY="readonly";o.tt=e.IDBKeyRange||e.webkitIDBKeyRange||e.msIDBKeyRange,o.ii={a:function(){},b:function(){},ll:2097152,c:function(e){return e==="object"||e==="array"?this.d:e==="datetime"?this.h:e==="date"?this.e:e==="time"?this.g:e==="boolean"?this.i:this.j},d:function(e){return JSON.parse(e)},e:function(e){var t=e.split("-");return new Date(t[0],t[1]-1,t[2],0,0,0,0)},g:function(e){var t=new Date,n=e.split(":");return t.setHours(n[0]),t.setMinutes(n[1]),t.setSeconds(n[2]),t},h:function(e){var t=e.split(" "),n=t[0].split("-"),r=t[1].split(":");return new Date(n[0],n[1]-1,n[2],r[0],r[1],r[2],0)},i:function(e){return!!e},j:function(e){return e},qq:["batch","destroy"],pp:["del","destroy","empty","get","getAll","getWithLike","getByCallback","getByIndex","getByIndexWithRange","put","set"],k:function(e){var t=this.pp,n=this.a,r,i;for(r=0,i=t.length;r<i;r++)e[t[r]]=n},l:function(e){var t=this.qq,n=this.pp,r,i,s,o=this.a,u,a;for(u=0,a=t.length;u<a;u++)e[t[u]]=o;s=e.vv;for(r in s){i=s[r];for(u=0,a=n.length;u<a;u++)i[n[u]]=o}},m:function(t){t=t.toLowerCase();if(t==="websql"){if(e.openDatabase)return o.a2.b6}else if(t==="indexeddb"&&o.rr)return o.a2.b5;if(e.openDatabase)return o.a2.b6;if(o.rr)return o.a2.b5},n:function(n){var r=n.ORM,i=n.b7,s=n.implementation,u=n.schemaDefinition,a=n.b8,f={},l;if(!r)throw Error(t);return typeof a[1]=="function"?(f.callback=a[1],f.context=a[2]||e):typeof a[1]=="object"&&(f=a[1]),o.a9.prototype=i,l=new o.a9(r,u,f),l.r=o.ii.p,l.q=o.ii.o,l.b4=s,l.d6(),l},o:function(e,n){var r=this.a4,i=this.a3,s=r[e];if(!s)throw Error(t);return s.cc(n,s.bb)},mm:{string:"TEXT",integer:"INTEGER",object:"TEXT",array:"TEXT",date:"DATE",time:"TIME",datetime:"DATETIME","float":"REAL","boolean":"INTEGER"},nn:{string:"",integer:0,object:"{}",array:"[]",date:"0000-00-00",time:"00:00:00",datetime:"0000-00-00 00:00:00","float":0,"boolean":0},oo:{string:"","int":0,integer:0,text:"",object:{},array:[],date:new Date(0,0,0),time:new Date(0,0,0),datetime:new Date(0,0,0),"float":0,"boolean":!1},p:function(e){var n=this.b4,r=o.ii.mm,i=n==="webSQL"?o.ii.nn:o.ii.oo,s=this.a3,u=this.a2.a3,a=this.a4[e],f,l=a.type,c=r[l],h=a.allowNull;if(!c)throw Error(t);f=this.a4[e],f.bb=h?n==="webSQL"?null:null:i[l],f.cc=n==="webSQL"?o.ii.jj.s(l):o.ii.kk.s(l),f.dd=o.ii.c(l),f.ee=l==="date"||l==="time"||l==="datetime",n==="webSQL"&&(f.ff=l,f.gg=c+(h?" NULL":""),f.hh=l==="object"||l==="array")}},o.ii.jj={s:function(e){if(e==="string"||e==="text")return this.t;if(e==="int"||e==="integer"||e==="float")return this.u;if(e==="object"||e==="array")return this.y;if(e==="date")return this.v;if(e==="time")return this.w;if(e==="datetime")return this.x;if(e==="boolean")return this.z},t:function(e,t){return e||t},u:function(e,t){return e-=0,e?e:t},v:function(e,t){var n,r;return e instanceof Date&&+e>=0?(n=e.getMonth()+1,r=e.getDate(),e.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)):(n=/^(\d{4}-\d{2}-\d{2})(?: \d{2}:\d{2}(?::\d{2}))?$/.exec(e),n?n[1]:t)},w:function(e,t){if(e instanceof Date&&+e>=0)return e.toTimeString().substring(0,8);var n=/^(?:\d{4}-\d{2}-\d{2} )?(\d{2}:\d{2})(:\d{2})?$/.exec(e);return n?n[1]+(n[2]||":00"):t},x:function(e,t){var n,r;return e instanceof Date&&+e>=0?(n=e.getMonth()+1,r=e.getDate(),e.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)+" "+e.toTimeString().substring(0,8)):(n=/^(\d{4}-\d{2}-\d{2})(?: |T)(\d{2}:\d{2})(?:(:\d{2})[^Z]+Z|(:\d{2}))?$/.exec(e),n?n[1]+" "+n[2]+(n[3]||n[4]||":00"):t)},y:function(e,t){if(typeof e=="undefined")return t;if(typeof e!="object")return e?typeof e=="string"?"'"+e+"'":e:t;try{return JSON.stringify(e)}catch(n){return t}},z:function(e,t){return typeof e=="string"?(e=e.toLowerCase(),e==="true"||e==="1"?1:e==="false"||e==="0"?0:t):e===1?1:e===0?0:t},aa:function(e){return e}},o.ii.kk={s:function(e){if(e==="string"||e==="text")return this.t;if(e==="int"||e==="integer"||e==="float")return this.u;if(e==="object"||e==="array")return this.y;if(e==="date")return this.v;if(e==="time")return this.w;if(e==="datetime")return this.x;if(e==="boolean")return this.z},t:function(e,t){return e?e+"":t},u:function(e,t){return e-=0,e?e:t},v:function(e,t){var n,r;return e instanceof Date&&!isNaN(e-0)?(e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e):(n=/^(\d{4}-\d{2}-\d{2})(?: \d{2}:\d{2}(?::\d{2}))?$/.exec(e),n?(n=n[1].split("-"),new Date(n[0],n[1]-1,n[2],0,0,0,0)):t)},w:function(e,t){if(e instanceof Date&&!isNaN(e-0))return e;var n=/^(\d{4}-\d{2}-\d{2} )?(\d{2}:\d{2})(:\d{2})?$/.exec(e);if(!n)return t;var r,i,s;return n[1]?(r=n[1].split("-"),r[1]=r[1]-1):(r=new Date,r=[r.getFullYear(),r.getMonth(),r.getDate()]),i=n[2].split(":"),s=n[3]||0,new Date(r[0],r[1],r[2],i[0],i[1],s,0)},x:function(e,t){var n,r;if(e instanceof Date&&!isNaN(e-0))return e;n=/^(\d{4}-\d{2}-\d{2})(?: |T)(\d{2}:\d{2})(?::(\d{2})[^Z]+Z|:(\d{2}))?$/.exec(e);if(!n)return t;var i,s,o;return i=n[1].split("-"),s=n[2].split(":"),o=n[3]||n[4]||0,new Date(i[0],i[1]-1,i[2],s[0],s[1],o,0)},y:function(e,t){return typeof e=="undefined"?t:typeof e!="object"?e?typeof e=="string"?"'"+e+"'":e:t:e},z:function(e,t){return typeof e=="string"?(e=e.toLowerCase(),e==="true"||e==="1"?!0:e==="false"||e==="0"?!1:t):e===1?!0:e===0?!1:t},aa:function(e){return e}},o.ORM=function(n,r,i){typeof n=="string"&&(n={name:n});if(!n.name)throw Error(t);return n.callback=typeof r=="function"?r:o.ii.b,n.context=i||e,o.a2.prototype=o.ii.m(n.prefered||""),new o.a2(n)},o.a2=function(e){var t=this.a3=e.name;this.forceDestroy=e.forceDestroy,this.uu=[],this.vv={},this.ww=[],this.Schema.a2=this,this.xx=!0,this.yy=[],this.zz=e.callback,this.a1=e.context,this.forceDestroy?this.c7(this.c1,this):this.c1()},o.a9=function(n,r,i){var s=n.a3,u=r.name;if(n.vv[u]&&!i.forceDestroy)throw Error(t);var a=r.fields;if(typeof a!="object"||!Object.keys(a).length)throw Error(t);var f=r.primaryKey;if(!f||f&&!a[f])throw Error(t);if(a[f].type!=="integer")throw Error(t);a[f].allowNull=!0;var l,c,h=[],p=[];for(l in a){c=a[l];if(c.index){if(!/^(integer|float|string|date|time|datetime)$/.test(c.type))throw Error(t);h.push(l),c.index=!0}else c.index=!1;c.unique?(p.push(l),c.unique=!0):c.unique=!1}n.vv[u]=this,this.a2=n,this.a3=u,this.a4=a,this.a5=h,this.a6=p,this.a7=f,this.a8=Object.keys(a),this.forceDestroy=i.forceDestroy,this.forceEmpty=this.forceDestroy?!1:i.forceEmpty,this.zz=typeof i.callback=="function"?i.callback:o.ii.b,this.a1=i.context||e},o.a2.b5={Schema:function(e){return o.ii.n({ORM:this.constructor.a2,b7:o.a9.b5,schemaDefinition:e,implementation:"indexedDB",b8:arguments})},l5:{k5:function(e){var t=e.ORM,n=t.n3,r=n.a3;this.ORM=t,this.m3=0,this.m2=!1,this.m4=null,this.m5=null,this.l6=e.l6,this.l7=e.l7,this.l8=e.l8,this.m1=e.m1,e.m6?(this.m8=this.k3,this.m9=s,this.n1=this.k2,this.m7=r):(this.m8=this.k2,this.m9=r,this.n1=this.k3,this.m7=s),this.k4()},k3:function(){return this.ORM.l1()},k2:function(){return this.ORM.j4()},k4:function(){var e=this,t=e.ORM,n=e.m9,r=e.m8();r.onsuccess=function(t){e.m5=this.result;var r=e.m5.transaction([n],o.ss.READ_ONLY),i=r.objectStore(n),s=i.openCursor();s.l9=e,s.onsuccess=e.k6},r.onerror=t.i8},k6:function(e){var t=this.l9,n=t.m5,r=this.result;r?t.m2?(t.m2=!1,n.close(),t.k7(r.value)):t.m3===0?(t.m3++,n.close(),t.k7(r.value)):(t.m2=!0,r.advance(t.m3),t.m3++):(n.close(),t.k9())},k7:function(e){var t=this,n=t.ORM,r=t.m7,i=t.n1();i.onsuccess=function(n){t.m4=this.result;var i=t.m4.transaction([r],o.ss.READ_WRITE),s=i.objectStore(r),u=t.m1(s,e,t.m3);u.l9=t,u.onsuccess=t.k8,u.onerror=t.k8},i.onerror=n.i8},k8:function(e){var t=this.l9;t.m4.close(),t.k4()},k9:function(){this.l6.call(this.l7,this.l8)}},c1:function(){var e=this,t=this.a3,n=this.l1();n.onupgradeneeded=function(e){var t=this.result,n;n=t.createObjectStore(r,{keyPath:"id",autoIncrement:!0}),n.createIndex(i,i,{unique:!0}),t.createObjectStore(s)},n.onsuccess=function(n){var s=this.result,u=s.transaction([r],o.ss.READ_WRITE),a=u.objectStore(r);a.index(i).get(t).onsuccess=function(n){var r=this.result;if(!r)e.n4=0,a.add({name:t,branch:0,schemas:{}}).onsuccess=function(t){s.close(),e.d6()};else{s.close();var i=r.branch;e.n4=i,e.d6()}}},n.onerror=function(e){this.zz.call(this.a1,null)}},d6:function(){this.zz.call(this.a1,!0),this.c4()},c7:function(t,s){var u=this,a=this.a3,f=o.rr.deleteDatabase(a);f.onsuccess=function(l){f=o.rr.open(n),f.onsuccess=function(n){var f=this.result,l=f.transaction([r],o.ss.READ_WRITE),c=l.objectStore(r);c.index(i).get(a).onsuccess=function(n){var r=this.result;c.delete(r.id).onsuccess=function(n){f.close(),o.ii.l(u),t.call(s||e,!0)}}}},f.onerror=function(n){t.call(s||e,!1)}},c3:function(e){this.yy.push(e),this.xx||this.c4()},c4:function(){var e=this,t=this.a3,n;this.yy.length?(n=this.l1(),n.onsuccess=function(n){var s=this.result,u=s.transaction([r],o.ss.READ_WRITE),a=u.objectStore(r);a.index(i).get(t).onsuccess=function(t){var n=this.result;e.i6(s,a,n)}},n.onerror=this.i8):this.c5()},i6:function(e,t,n){var r=this,i=this.a3,s=this.yy.shift(),o=s.a3,u=n.schemas[o],a={fields:s.a4,primaryKey:s.a7};this.n3=s,u?s.forceDestroy?this.e5(this.e8):(e.close(),this.e1(u,a)?s.forceEmpty?this.e5(this.e8,this):this.e3():s.forceEmpty?this.e9():this.j1()):(this.i7(t,n),e.close(),this.e2())},e1:function(e,t){var n=!1,r=e.fields,i=t.fields,s,o;for(fieldName in r){s=r[fieldName],o=i[fieldName];if(!o||s.type!==o.type||s.index!==o.index||s.unique!==o.unique){n=!0;break}}var u=e.primaryKey,a=t.primaryKey;return!n&&(u&&(!a||u!==a)||!u&&a)&&(n=!0),n},i7:function(e,t){var n=this.n3,r=n.a3,i=n.a7,s=n.b3;return t.schemas[r]={fields:s,primaryKey:i},req=e.put(t),req},e2:function(){var e=this,t=this.n3,n=this.a3,r=t.a3,i=this.j3();i.onupgradeneeded=function(t){var n=this.result;e.i9(n)},i.onsuccess=function(t){var n=this.result;n.close(),e.j2(e.j1,e)},i.onerror=this.i8},e3:function(){var e=this,t=this.l1();t.onsuccess=function(t){var n=this.result,r=n.transaction([s],o.ss.READ_WRITE),i=r.objectStore(s);i.clear().onsuccess=function(t){n.close(),e.e4()}},t.onerror=this.i8},e4:function(){var e=this,t=this.n3,n=t.a3,r=function(e,t,n){return e.add(t,n)};this.l5.k5({ORM:this,m6:!1,l6:this.e5,l7:this,l8:this.e6,m1:r})},e5:function(e){var t=this,n=this.n3,r=n.a3,i=this.a3,s=this.j3();s.onupgradeneeded=function(e){var n=this.result;n.deleteObjectStore(r),t.i9(n)},s.onsuccess=function(n){var r=this.result;r.close(),t.j2(e,t)},s.onerror=this.i8},e6:function(){var e=this,t=this.n3,n=t.a3,r=t.a4,i=function(e,t){var n,i;for(i in t)n=r[i],n?t[i]=n.cc(t[i],n.bb):delete t[i];return e.put(t)};this.l5.k5({ORM:this,m6:!0,l6:this.e7,l7:this,m1:i})},e7:function(){var e=this,t=this.a3,n;n=this.l1(),n.onsuccess=function(t){var n=this.result,r=n.transaction([s],o.ss.READ_WRITE),i=r.objectStore(s);i.clear().onsuccess=function(t){n.close(),e.e8()}},n.onerror=this.i8},e8:function(){var e=this,t=this.a3,n=this.n3,s=n.a3,u;u=this.l1(),u.onsuccess=function(n){var s=this.result,u=s.transaction([r],o.ss.READ_WRITE),a=u.objectStore(r);a.index(i).get(t).onsuccess=function(t){var n=this.result,r;r=e.i7(a,n),r.onsuccess=function(t){s.close(),e.f1()}}},u.onerror=this.i8},e9:function(){var e=this,t=this.a3,n=this.n3,r=n.a3,i;i=this.j4(),i.onsuccess=function(t){var n=this.result,i=n.transaction([r],o.ss.READ_WRITE),s=i.objectStore(r);s.clear().onsuccess=function(t){e.f1()}},i.onerror=this.i8},f1:function(){this.j1()},i8:function(){this.j1(!1)},i9:function(e){var t=this.n3,n=t.a4,r=t.a3,i=t.a7,s,o,u,a;a=e.createObjectStore(r,{keyPath:i,autoIncrement:!0});for(s in n)o=n[s],o.index&&(u=o.unique,a.createIndex(s,s,u?{unique:!0}:{}))},j1:function(e){var t=this.n3,n=t.zz,r=t.a1;n.call(r,typeof e=="undefined"?!0:e),delete t.zz,delete t.a1,delete this.n3,this.c4()},c5:function(){this.xx=!1},j2:function(t,n){var s=this,u=this.a3,a=this.n4,f;f=this.l1(),f.onsuccess=function(s){var f=this.result,l=f.transaction([r],o.ss.READ_WRITE),c=l.objectStore(r);c.index(i).get(u).onsuccess=function(r){var i=this.result;i.branch=a,c.put(i),f.close(),t&&t.call(n||e)}}},j3:function(){var e=this.a3,t=this.n4+1;return this.n4=t,o.rr.open(e,t)},j4:function(){var e=this.a3,t=this.n4;return o.rr.open(e,t)},l1:function(){return o.rr.open(n,1)},j5:function(t){t.callback||(t.callback=o.ii.b),t.context||(t.context=e),this.uu.push(t);if(this.b2)return;this.b2=!0,this.j6()},j6:function(){var e=this.uu.shift();e.type==="destroy"?this.f4(e):this.l2(e,this._exec2,this)},_exec2:function(e){var t=e.schema,n=e.type;this["_"+n](e)},l2:function(e,t,n){var r=e.schema,i=this.j4();i.onsuccess=function(i){var s=this.result,u=e.type,a=s.transaction([r],o.ss.READ_WRITE);objectStore=a.objectStore(r),e.objectStore=objectStore,e.database=s,t.call(n,e)}},d4:function(){this.b2=!1,this.uu.length&&this.j6()},j7:function(e,t){e.database.close(),e.callback.call(e.context,t),this.d4()},_put:function(e){var t=this,n=e.objectStore,r=e.data,i=0,s=r.length,o=function(n){i===s?t.j7(e,n):(u(),i++)},u=function(){var u=r[i],a=n.add(u);a.onsuccess=function(e){o(this.result)},a.onerror=function(r){i!==s?(e.database.close(),t.l2(e,function(){n=e.objectStore,o(!1)},t)):o(!1)}};o()},_set:function(e){var t=this,n=e.objectStore,r=e.data,i=e.indexes,s=e.primaryKey,o=0,u=0,a=r.length,f=function(){u===a?t.j7(e,o):(l(),u++)},l=function(){var e=r[u],t=e.data,i=e.target,a=i[s],l,c=Object.keys(i).length;a?n.get(a).onsuccess=function(e){var r=this.result,i;if(r){for(l in t)r[l]=t[l];i=n.put(r),i.onsuccess=function(e){this.result&&o++,f()},i.onerror=function(e){f(!1)}}else f()}:n.openCursor().onsuccess=function(e){var n=this.result;if(n){var r=n.value,s=0,u;for(l in i)r[l]===i[l]&&s++;if(s===c){for(l in t)r[l]=t[l];u=n.update(r),u.onsuccess=function(e){this.result&&o++,n.continue()},u.onerror=function(e){n.continue()}}else n.continue()}else f()}};f()},_del:function(e){var t=this,n=e.objectStore;n.count().onsuccess=function(n){e.n5=this.result,t.l3(e)}},l3:function(e){var t=this,n=e.data,r=e.primaryKey,i=0,s=n.length,o=function(){i===s?t.l4(e):(u(),i++)},u=function(){var e=n[i];objectStore.delete(e[r]).onsuccess=function(e){o()}};o()},l4:function(e){var t=this,n=e.objectStore;n.count().onsuccess=function(n){t.j7(e,e.n5-this.result)}},_empty:function(e){var t=this,n,r=e.objectStore;r.count().onsuccess=function(i){n=this.result,r.clear().onsuccess=function(r){t.j7(e,n)}}},f4:function(e){var t=this,n=e.schema,r=this.j3();r.onupgradeneeded=function(e){var t=this.result;t.deleteObjectStore(n)},r.onsuccess=function(n){var r=this.result;r.close(),t.j8(e)}},j8:function(e){var t=this,n=this.a3,s=e.schema,u=this.vv[s],a=this.l1();a.onsuccess=function(a){var f=this.result,l=f.transaction([r],o.ss.READ_WRITE),c=l.objectStore(r);c.index(i).get(n).onsuccess=function(n){var r=this.result;delete r.schemas[s],c.put(r).onsuccess=function(n){t.j2(function(){e.database=f,delete t.vv[s],o.ii.k(u),this.j7(e,!0)},t)}}}},batch:function(n,r,i){var s=this.a3,u;if(!(n instanceof Array)||!n.length)throw Error(t);typeof r!="function"&&(r=o.ii.b),typeof i!="object"&&(i=e),u={data:n,callback:r,context:i};if(this.b1){this.ww.push(u);return}this.b1=!0,this.d5(u)},d5:function(n){var r=n.data,i=["set","put","del"],s=0,u=r.length,a,f,l,c;for(;s<u;s++){f=r[s],l=f.schema;if(!(l instanceof o.a9))throw Error(t);c=f.type.toLowerCase();if(i.indexOf(c)===-1)throw Error(t);a=l[c](f.data),a.callback=o.ii.b,a.context=e,this.uu.push(a)}a=this.uu[this.uu.length-1],a.callback=n.callback,a.context=n.context,this.b1=!1,this.b2||this.d4()},destroy:function(e,t){typeof e!="function"&&(e=o.ii.a),this.c7(e,t)}},o.a9.b5={d6:function(){var e=this.a2,t=this.a4,n,r,i={};for(n in t)r=t[n],this.r(n),i[n]={type:r.type,index:r.index,unique:r.unique};this.b3=i,e.c3(this)},get:function(e,n,r){var i=this.a2,s=i.a3,o=this.a4,u,a={},f=this.a3;if(!e)throw Error(t);for(u in o)a[u]=this.q(u,e);var l=function(e,t,n){for(var r in e)if(e[r]===n[r])return!0;return!1};this.j9({callback:l,comparator:a,fields:null},n,r)},getAll:function(e,t){var n=this.a2,r=n.a3,i=this.a3,s=function(){return!0};this.j9({callback:s,comparator:null,fields:null},e,t)},getWithLike:function(e,n,r,i){var s=this.a2,o=s.a3,u=this.a4,a=this.a3,f,l,c,h,p;if(typeof n!="object")throw Error(t);h=Object.keys(n)[0],p=n[h];if(!h||!p)throw Error(t);h==="both"?p=new RegExp(p,"i"):h==="start"?p=new RegExp("^"+p,"i"):h==="end"&&(p=new RegExp(p+"$","i")),e instanceof Array||(e=[e]);for(f=0,l=e.length;f<l;f++){c=e[f];if(!u[c])throw Error(t)}var d=function(e,t,n){var r,i=0,s=t.length;for(;i<s;i++){r=t[i];if(n.test(e[r]))return!0}return!1};this.j9({callback:d,comparator:p,fields:e},r,i)},getByCallback:function(e,n,r){var i=this.a2,s=i.a3,o=this.a3;if(typeof e!="function")throw Error(t);this.j9({callback:e,comparator:null,fields:null},n,r)},j9:function(t,n,r){var i={filterData:t,callback:n||o.ii.b,context:r||e,self:this};(function(e){var t=e.self,n=t.a2,r=n.j4(),i,s=n.a3,u=t.a3,a=e.filterData,f=a.callback,l=a.comparator,c=a.fields,h=[];r.onsuccess=function(t){var n=this.result,r=n.transaction([u],o.ss.READ_ONLY);objectStore=r.objectStore(u),i=n,objectStore.openCursor().onsuccess=function(t){var n=this.result,r;n?(r=n.value,f(r,c,l)&&h.push(r),n.continue()):(i.close(),e.callback.call(e.context,h))}}})(i)},getByIndex:function(e,n,r,i){var s=this.a2,u=s.a3,a=this.a3,f={},l=[],c,h,p,d,v;if(this.a7!==e&&this.a5.indexOf(e)===-1)throw Error(t);this.a7===e?f.pk=e:f.index=e;if(!n)throw Error(t);n instanceof Array||(n=[n]);if(n.length===1)f.keyRange=o.tt.only(this.q(e,n[0])),this.k1(f,r,i);else{for(d=0,v=n.length;d<v;d++)h=n[d],p=this.q(e,h),l.push(p);c=function(e,t,n){for(var r=0,i=t.length;r<i;r++)if(t[r]===e[n])return!0;return!1},this.j9({callback:c,comparator:f.pk||f.index,fields:l},r,i)}},getByIndexWithRange:function(e,n,r,i){var s=this.a2,u=s.a3,a=this.a3,f=this.a4,l=/^(?:>|<|>=|<=|=)$/,c,h={},p={},d,v,m=f[e],g,y;if(this.a7!==e&&this.a5.indexOf(e)===-1)throw Error(t);this.a7===e?h.pk=e:h.index=e,g=n["="],g&&m.ee&&(n={">=":g,"<=":g});for(c in n){if(!l.test(c))throw Error(t);g=n[c],y=this.q(e,g);if(!y&&y!==m.bb)throw Error(t);p[c]=y}d=Object.keys(p).length;if(d===2)try{p[">"]&&p["<"]?v=o.tt.bound(p[">"],p["<"],!0,!0):p[">="]&&p["<="]?v=o.tt.bound(p[">="],p["<="]):p[">"]&&p["<="]?v=o.tt.bound(p[">"],p["<="],!0,!1):v=o.tt.bound(p[">="],p["<"],!1,!0)}catch(b){throw Error(t)}else d===1&&(p[">"]?v=o.tt.lowerBound(p[">"],!0):p[">="]?v=o.tt.lowerBound(p[">="]):p["<"]?v=o.tt.upperBound(p["<"],!0):p["<="]?v=o.tt.upperBound(p["<="]):v=o.tt.only(p["="]));if(!v)throw Error(t);h.keyRange=v,this.k1(h,r,i)},k1:function(t,n,r){var i={range:t,callback:n||o.ii.b,context:r||e,self:this};(function(e){var t=e.self,n=t.a2,r=e.range,i=r.pk,s=r.index,u=r.keyRange,a=n.j4(),f,l=n.a3,c=t.a3,h=[],p=function(t){var n=this.result;n?(h.push(n.value),n.continue()):(f.close(),e.callback.call(e.context,h))};a.onsuccess=function(e){var t=this.result,n=t.transaction([c],o.ss.READ_ONLY);objectStore=n.objectStore(c),f=t,i?objectStore.openCursor(u).onsuccess=p:objectStore.index(s).openCursor(u).onsuccess=p}})(i)},put:function(e,t,n){var r=this.a2,i=r.a3,s=this.a8,o,u=this.a7,a=this.a3,f,l,c,h,p=s.length,d;!(e instanceof Array)&&typeof e=="object"&&(e=[e]);for(l=0,c=e.length;l<c;l++){f=e[l];for(h=0;h<p;h++)o=s[h],f[o]=this.q(o,f[o]);f[u]<=0&&delete f[u]}d={type:"put",schema:a,primaryKey:u,data:e,callback:t,context:n};if(r.b1)return d;r.j5(d)},set:function(e,n,r){var i=this.a2,s=this.a3,o=this.a4,u=i.a3,a,f,l,c,h,p,d={},v={},m=[],g,y,b;if(!e||typeof e!="object")throw Error(t);e instanceof Array||(e=[e]);for(g=0,y=e.length;g<y;g++){f=e[g];if(!f.data||typeof f.data!="object"||!Object.keys(f.data).length)throw Error(t);if(f.target){if(typeof f.target!="object"||!Object.keys(f.target).length)throw Error(t)}else f.target=[];l=f.target;for(h in l){p=l[h],parsedValue=this.q(h,p);if(!parsedValue&&parsedValue!==o[h].bb)throw Error(t);d[h]=parsedValue}c=f.data;for(h in c){p=c[h],parsedValue=this.q(h,p);if(!parsedValue&&parsedValue!==o[h].bb)throw Error(t);v[h]=parsedValue}m.push({data:v,target:d}),v={},d={}}b={type:"set",schema:s,indexes:this.a5,primaryKey:this.a7,data:m,callback:n,context:r};if(i.b1)return b;i.j5(b)},del:function(e,n,r){var i=this.a2,s=i.a3,o=this.a7,u=this.a3,a,f,l,c=[],h,p,d;if(!o)throw Error(t);if(!e)throw Error(t);e instanceof Array||(e=[e]);for(h=0,p=e.length;h<p;h++){a=e[h],f=this.q(o,a);if(!f)throw Error(t);l={},l[o]=f,c.push(l)}d={type:"del",schema:u,primaryKey:o,data:c,callback:n,context:r};if(i.b1)return d;i.j5(d)},destroy:function(e,t){var n=this.a2,r=n.a3,i=this.a3;n.j5({type:"destroy",schema:i,callback:e,context:t})},empty:function(e,t){var n=this.a2,r=n.a3,i=this.a3;n.j5({type:"empty",schema:i,callback:e,context:t})}},o.a2.b6={Schema:function(e){return o.ii.n({ORM:this.constructor.a2,b7:o.a9.b6,schemaDefinition:e,implementation:"webSQL",b8:arguments})},c1:function(){(function(t){t.f8=e.openDatabase(n,1,"",o.ii.ll),t.f8.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS databases( id INTEGER PRIMARY KEY, name TEXT UNIQUE, schemas TEXT )"),e.executeSql('SELECT * FROM databases WHERE name = "'+t.a3+'"',[],function(e,n){t.c2(n)})})})(this)},c2:function(t){var n=t.rows;this.f9=n.length?JSON.parse(n.item(0).schemas):{},this.g1=[],this.g2=e.openDatabase(this.a3,1,"",o.ii.ll),this.zz.call(this.initContext,!0),this.c4()},c3:function(e){this.yy.push(e),this.xx||(this.xx=!0,this.c4())},c4:function(){var e=this,t=this.a3;this.yy.length?this.yy.shift().d7():this.c5()},c5:function(){this.xx=!1},c6:function(e,t,n){var r=this,i=this.a3,s=this.f9;this.f8.transaction(function(r){r.executeSql('REPLACE INTO databases( name, schemas ) VALUES( "'+i+'", '+"'"+JSON.stringify(s)+"'"+")",[],function(){e.call(t,n)})})},c7:function(e,t){this.destroy(e,t)},c8:function(e,t){var n=e.a3;delete this.vv[n],delete this.f9[n],o.ii.k(e),this.c6(t.g7,t.g8,!0)},c9:function(e){},d1:function(n){var r=n.g7,i=n.g8;if(r&&typeof r!="function")throw Error(t);r||(n.g7=o.ii.b);if(i&&typeof i!="object")throw Error(t);i||(n.g8=e);if(this.b2){n.h9?this.g1.push(n):this.uu.push(n);return}this.b2=!0,this.d2(n)},d2:function(e){this.g3=e;var t=this,n=0,r=e.g4;r instanceof Array||(r=[r]);var i=e.g6?function(e,t){n+=t.rowsAffected}:o.ii.a,s=function(r,i){e.g6?e.i3=i.rowsAffected+n:e.h1?e.i3=i.insertId:e.g9&&(e.i3=i.rowsAffected),t.d3(i)},u=function(e,n){t.c9(n)},a=function(e,n){t.c9(n),t.d3(!1)};this.g2.transaction(function(t){var n,o=r.length;while(o--)n=r.shift(),t.executeSql(n,e.g5?e.g5.shift():[],o?i:s,o?u:a)})},d3:function(e){queryData=this.g3,this.b2=!1,e||(queryData.i3=!1),queryData.i1?queryData.i1.call(queryData.i2,e,queryData):queryData.g7.call(queryData.g8,queryData.i3),this.d4()},d4:function(){this.b2||(this.g1.length?this.d1(this.g1.shift()):this.uu.length&&!this.xx&&this.d1(this.uu.shift()))},batch:function(n,r,i){var s=this.a3,u;if(!(n instanceof Array)||!n.length)throw Error(t);typeof r!="function"&&(r=o.ii.b),typeof i!="object"&&(i=e),u={data:n,callback:r,context:i};if(this.b1){this.ww.push(u);return}this.b1=!0,this.d5(u)},d5:function(e){var n=e.data,r=["set","put","del"],i,s,u,a=0,f=n.length;for(;a<f;a++){i=n[a],s=i.schema;if(!(s instanceof o.a9))throw Error(t);u=i.type.toLowerCase();if(r.indexOf(u)===-1)throw Error(t);this.uu.push(s[u](i.data))}var l=this.uu[this.uu.length-1];l.g7=e.callback,l.g8=e.context,this.b1=!1,this.d4(),this.ww.length&&this.d5(this.ww.shift())},destroy:function(t,n){typeof t!="function"&&(t=o.ii.a),t.call(n||e,!1)}},o.a9.b6={d6:function(){var e=this.a4,t,n,r=this.a2,i=r.a3,s=this.a3,o=[],u=this.a7,a,f={},l,c,h={};for(n in e)t=e[n],a=[],u===n?a.push("PRIMARY KEY"):(l=t.index,c=t.unique,l&&c?f[n]=!0:c?a.push("UNIQUE"):l&&(f[n]=!1)),this.r(n),h[n]={type:t.type,index:t.index,unique:t.unique},o.push(n+" "+e[n].gg+(a.length?" "+a.join(" "):""));this.h2='CREATE TABLE "'+s+'" ( '+o.join(", ")+" )",this.b3=h,this.i5=f,this.h4=[],r.c3(this)},d7:function(){var e=this.a2,t=e.a3,n=this.a3,r=this.h2,i,s,o;this.forceDestroy?(i="DROP TABLE IF EXISTS "+n,e.d1({g4:[i,r],i2:this,i1:this.e4,h9:!0})):(o={fields:this.b3,primaryKey:this.a7},s=e.f9[n],s?this.e1(s,o):(e.f9[n]=o,this.a2.c6(this.e2,this)))},d8:function(e,t,n){return"CREATE UNIQUE INDEX "+this.f7(e,t)+" ON "+(n||e)+" ( "+t+" )"},d9:function(e,t,n){return"CREATE INDEX "+this.f7(e,t)+" ON "+(n||e)+" ( "+t+" )"},f7:function(e,t){return e+"_"+t},e1:function(e,t){var n=this.a2,r=n.a3,i=this.a3,s=!1,o=e.fields,u=t.fields,a,f,l;for(l in o){a=o[l],f=u[l];if(!f||a.type!==f.type||a.unique!==f.unique){s=!0;break}}var c=e.primaryKey,h=t.primaryKey;!s&&(c&&(!h||c!==h)||!c&&h)&&(s=!0);if(s)n.f9[i]=t,this.a2.c6(this.e3,this);else{var p=[],d=this.a5,v=this.i5;for(l in o)a=o[l],a.index&&(d.indexOf(l)===-1?p.push(l):delete v[l]);p.length||Object.keys(v).length?(this.h4=p,n.f9[i]=t,this.a2.c6(this.f6,this)):this.f1()}},e2:function(){var e=this.a2,t=this.a3,n=e.a3,r=this.h2;e.d1({g4:r,i2:this,i1:this.f1,h9:!0})},e3:function(){var e=this.a2,t=this.h2,n=this.a3,r=n+ +(new Date),i=t.replace('CREATE TABLE "'+n+'"','CREATE TABLE "'+r+'"');this.h5=0,this.h6=r,e.d1({g4:i,i2:this,i1:this.e4,h9:!0})},e4:function(){var e=this.a2,t=e.a3,n=this.a3,r=this.h6,i=[],s=this.i5;for(fieldName in s)i.push("DROP INDEX IF EXISTS "+this.f7(n,fieldName)),s[fieldName]?i.push(this.d8(n,fieldName,r)):i.push(this.d9(n,fieldName,r));i.length?e.d1({g4:i,i2:this,i1:this.e5,h9:!0}):this.e5()},e5:function(){var e=this.a2,t=this.a3,n=this.h6,r=this.h5,i;this.forceEmpty?(this.i4=!0,this.f5()):this.forceDestroy?this.f1():this.e6()},e6:function(){var e=this.a2,t=this.a3,n=this.h6,r="SELECT * FROM "+t+" LIMIT "+this.h5+", 500";e.d1({g4:r,i2:this,i1:this.e7,h9:!0})},e7:function(e){var t=this.a2,n=this.a4,r=this.a3,i=this.h6,s=e.rows,o,u,a,f=[],l,c=[],h=[],p=[],d=[],v,m,g,y;if(!s.length)this.e8();else{o=s.item(0);for(u in o)n[u]&&f.push(u);for(u in n)a=n[u],f.indexOf(u)===-1&&(f.push(u),h.push(a.bb),c.push("?"));for(m=0,g=s.length;m<g;m++){v=[],l=[],o=s.item(m);for(u in o)a=n[u],a&&(l.push("?"),a.hh?v.push(o[u]):v.push(a.cc(o[u],a.bb)));p.push("INSERT INTO "+i+" ( "+f.join(", ")+" ) VALUES ( "+l.concat(c).join(", ")+" )"),d.push(v.concat(h))}y={g4:p,g5:d,i2:this,h9:!0},g===500?(this.h5+=500,y.i1=this.e6):y.i1=this.e8,t.d1(y)}},e8:function(){var e=this.a2,t=this.a3,n="DROP TABLE "+t,r=this.h6,i="ALTER TABLE "+r+" RENAME TO "+t;e.d1({g4:[n,i],i2:this,i1:this.e9,h9:!0})},e9:function(){var e=this.a2;delete this.h6,delete this.h5,delete this.h4,this.forceEmpty&&!this.i4?this.f5():this.f1()},f1:function(){var e=this.a2;delete this.h2,delete this.i5,delete this.i4,this.zz.call(this.a1,!0),delete this.zz,delete this.a1,e.c4()},f5:function(){var e=this.a2,t=e.a3,n=this.a3,r="DELETE FROM "+n;e.d1({g4:[r],i2:this,i1:this.e9,h9:!0})},f6:function(){var e=this.a2,t=this.a3,n=[],r=this.h4,i,s=this.i5;while(r.length)n.push("DROP INDEX "+this.f7(t,r.shift()));for(i in s)s[i]?n.push(this.d8(t,i)):n.push(this.d9(t,i));e.d1({g4:n,i2:this,i1:this.e9,h9:!0})},get:function(e,n,r){var i=this.a2,s=this.a4,o,u=i.a3,a=this.a3,f,l=[],c=[];if(!e)throw Error(t);for(o in s)l.push(o+" = ?"),c.push(this.q(o,e));f="SELECT * FROM "+a+" WHERE "+l.join(" OR "),i.d1({g4:f,g5:[c],i1:this.f3,i2:this,g7:n,g8:r})},getByCallback:function(e,n,r){var i=this.a2,s=this.a4,o,u=this.a3,a;if(typeof e!="function")throw Error(t);a="SELECT * FROM "+u,i.d1({g4:a,i2:this,i1:this.f2,g7:n,g8:r,b9:e})},f2:function(e,t){var n=this.a4,r=e.rows,i=0,s=r.length,o,u,a=t.b9,f,l=[];for(;i<s;i++){o=r.item(i),f={};for(u in o)f[u]=n[u].dd(o[u]);a(f)&&l.push(f)}t.g7.call(t.g8,l)},getByIndex:function(e,n,r,i){var s=this.a2,o=s.a3,u=this.a3,a,f=[],l=[],c,h,p,d;if(this.a7!==e&&this.a5.indexOf(e)===-1)throw Error(t);if(!n)throw Error(t);n instanceof Array||(n=[n]);for(p=0,d=n.length;p<d;p++)c=n[p],h=this.q(e,c),f.push(e+" = ?"),l.push(h);a="SELECT * FROM "+u+(f.length?" WHERE "+f.join(" OR "):""),s.d1({g4:a,g5:[l],i2:this,i1:this.f3,g7:r,g8:i})},getByIndexWithRange:function(e,n,r,i){var s=this.a2,o=s.a3,u=this.a3,a=this.a4,f=/^(?:>|<|>=|<=|=)$/,l,c=[],h,p,d=[],v;if(this.a7!==e&&this.a5.indexOf(e)===-1)throw Error(t);for(l in n){if(!f.test(l))throw Error(t);h=n[l],p=this.q(e,h);if(!p&&p!==a[e].bb)throw Error(t);c.push(e+" "+l+" ?"),d.push(p)}if(!c.length)throw Error(t);v="SELECT * FROM "+u+" WHERE "+c.join(" AND "),s.d1({g4:v,g5:[d],i2:this,i1:this.f3,g7:r,g8:i})},getAll:function(e,t){var n=this.a2,r=this.a3,i="SELECT * FROM "+r;n.d1({g4:i,i2:this,i1:this.f3,g7:e,g8:t})},getWithLike:function(e,n,r,i){var s=this.a2,o=s.a3,u=this.a4,a=this.a3,f,l,c,h,p,d=[],v,m=[];if(typeof n!="object")throw Error(t);h=Object.keys(n)[0],p=n[h];if(!h||!p)throw Error(t);h==="both"?p="%"+p+"%":h==="start"?p+="%":h==="end"&&(p="%"+p),e instanceof Array||(e=[e]);for(f=0,l=e.length;f<l;f++){c=e[f];if(!u[c])throw Error(t);m.push(c+" LIKE ?"),d.push(p)}v="SELECT * FROM "+a+" WHERE "+m.join(" OR "),s.d1({g4:v,g5:[d],i2:this,i1:this.f3,g7:r,g8:i})},f3:function(e,t){var n=this.a4,r=e.rows,i=0,s=r.length,o,u,a,f=[];for(;i<s;i++){o=r.item(i),a={};for(u in o)a[u]=n[u].dd(o[u]);f.push(a)}t.g7.call(t.g8,f)},put:function(e,t,n){var r=this.a2,i=r.a3,s=this.a8,o,u=this.a3,a,f=[],l,c,h=[],p,d,v,m,g=s.length,y;!(e instanceof Array)&&typeof e=="object"&&(e=[e]);for(d=0,v=e.length;d<v;d++){p=e[d],a=[],l=[],c=[];for(m=0;m<g;m++)o=s[m],a.push(o),l.push(this.q(o,p[o])),c.push("?");f.push(l),h.push("INSERT INTO "+u+" ( "+a.join(", ")+" ) "+"VALUES ( "+c.join(" , ")+" )")}y={g4:h,g5:f,g7:t,g8:n,h1:!0};if(r.b1)return y;r.d1(y)},set:function(e,n,r){var i=this.a2,s=this.a3,o=i.a3,u=this.a4,a,f,l,c,h,p,d,v,m=[],g,y=[],b,w,S;if(!e||typeof e!="object")throw Error(t);e instanceof Array||(e=[e]);for(b=0,w=e.length;b<w;b++){f=e[b],g=[],v=[],d=[];if(!f.data||typeof f.data!="object"||!Object.keys(f.data).length)throw Error(t);if(f.target){if(typeof f.target!="object"||!Object.keys(f.target).length)throw Error(t)}else f.target=[];c=f.data;for(h in c){p=c[h],parsedValue=this.q(h,p);if(!parsedValue&&parsedValue!==u[h].bb)throw Error(t);v.push(h+" = ?"),g.push(parsedValue)}l=f.target;for(h in l){p=l[h],parsedValue=this.q(h,p);if(!parsedValue&&parsedValue!==u[h].bb)throw Error(t);d.push(h+" = ?"),g.push(parsedValue)}y.push("UPDATE "+s+" SET "+v.join(", ")+(d.length?" WHERE "+d.join(" AND "):"")),m.push(g)}S={g4:y,g5:m,g6:!0,g7:n,g8:r};if(i.b1)return S;i.d1(S)},del:function(e,n,r){var i=this.a2,s=i.a3,o=this.a7,u=this.a3,a,f,l,c=[],h,p,d;if(!o)throw Error(t);if(!e)throw Error(t);e instanceof Array||(e=[e]);for(h=0,p=e.length;h<p;h++){a=e[h],f=this.q(o,a);if(!f)throw Error(t);c.push(o+" = "+f)}l="DELETE FROM "+u+(c.length?" WHERE "+c.join(" OR "):""),d={g4:l,g9:!0,g7:n,g8:r};if(i.b1)return d;i.d1(d)},destroy:function(e,t){var n=this.a2,r=this.a3,i="DROP TABLE "+r;n.d1({i1:this.f4,i2:this,g4:i,g7:e,g8:t})},f4:function(e,t){var n=this.a2;e&&n.c8(this,t)},empty:function(e,t){var n=this.a2,r=this.a3,i="DELETE FROM "+r;n.d1({g4:i,g9:!0,g7:e,g8:t})}},e.MSQTA=o})(window)