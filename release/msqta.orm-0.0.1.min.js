(function(e){var t="MSQTA-ORM!",n="transaction",r="continue",i="result",s="__msqta__",o="databases",u="name",a="dump",f="onsuccess",l="onerror",c="onupgradeneeded",h="executeSql",p=" __currents_ids__ ",d=d||{};d._a2=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,d._a3=e.IDBTransaction||e.webkitIDBTransaction||e.msIDBTransaction,d._a3&&(!d._a3.READ_WRITE||!d._a3.READ_ONLY)&&(d._a3={READ_WRITE:"readwrite",READ_ONLY:"readonly"}),d._a4=e.IDBKeyRange||e.webkitIDBKeyRange||e.msIDBKeyRange,d._Messages={"app is working":"The application is currently manipulating your local database, please wait a moment, leaving the application right now will cause that your database may get broken!"},d._ss={a:function(){},b:function(){},pp:function(){e.addEventListener("beforeunload",this.rr,!1)},qq:function(){e.removeEventListener("beforeunload",this.rr,!1)},rr:function(e){return e.returnValue=d._Messages["app is working"],d._Messages["app is working"]},vv:2097152,c:function(e){return e==="object"||e==="array"?this.d:e==="datetime"?this.h:e==="date"?this.e:e==="time"?this.g:e==="boolean"?this.n:this.o},d:function(e){return JSON.parse(e)},e:function(e){var t;return(t=d._ss.oo(e))?t:(t=e.split("-"),new Date(t[0],t[1]-1,t[2],0,0,0,0))},g:function(e){var t,n;return(t=d._ss.oo(e))?t:(t=new Date,n=e.split(":"),t.setHours(n[0]),t.setMinutes(n[1]),t.setSeconds(n[2]),t)},h:function(e){var t,n,r;return(t=d._ss.oo(e))?t:(t=e.split(" "),n=t[0].split("-"),r=t[1].split(":"),new Date(n[0],n[1]-1,n[2],r[0],r[1],r[2],0))},n:function(e){return!!e},o:function(e){return e},a1:["batch","destroy"],zz:["del","destroy","empty","get","getAll","getWithLike","getByCallback","getByIndex","getByIndexWithRange","put","set"],p:function(e){var t=this.zz,n=this.a,r,i;for(r=0,i=t.length;r<i;r++)e[t[r]]=n},r:function(e){var t=this.a1,n=this.zz,r,i,s,o=this.a,u,a;for(u=0,a=t.length;u<a;u++)e[t[u]]=o;s=e._a6;for(r in s){i=s[r];for(u=0,a=n.length;u<a;u++)i[n[u]]=o}},s:function(t){t=t.toLowerCase();if(t==="websql"){if(e.openDatabase)return d._b3.c7}else if(t==="indexeddb"&&d._a2)return d._b3.c6;if(e.openDatabase)return d._b3.c7;if(d._a2)return d._b3.c6},t:function(n,r,i,s,o){var u={},a;if(!n)throw t;return typeof o[1]=="function"?(u.callback=o[1],u.context=o[2]||e):typeof o[1]=="object"&&(u=o[1]),d._c1.prototype=r,a=new d._c1(n,i,u),a._x=d._ss.v,a._w=d._ss.u,a._c5=s,a._f2(),a},u:function(e,n){var r=this._b5,i=this._b4,s=r[e];if(!s)throw t;return s.ii(n,s.hh)},ww:{string:"TEXT",integer:"INTEGER",object:"TEXT",array:"TEXT",date:"DATE",time:"TIME",datetime:"DATETIME","float":"REAL","boolean":"INTEGER"},xx:{string:"",integer:0,object:"{}",array:"[]",date:"0000-00-00",time:"00:00:00",datetime:"0000-00-00 00:00:00","float":0,"boolean":0},yy:{string:"","int":0,integer:0,text:"",object:{},array:[],date:new Date(0,0,0),time:new Date(0,0,0),datetime:new Date(0,0,0),"float":0,"boolean":!1},v:function(e){var n=this._c5,r=d._ss.ww,i=n==="webSQL"?d._ss.xx:d._ss.yy,s=this._b4,o=this._b3._b4,u=this._b5[e],a,f=u.type,l=r[f],c=u.allowNull;if(!l)throw t;a=this._b5[e],a.hh=c?n==="webSQL"?null:null:i[f],a.ii=n==="webSQL"?d._ss.tt.y(f):d._ss.uu.y(f),a.jj=d._ss.c(f),a.kk=f==="date"||f==="time"||f==="datetime",n==="webSQL"&&(a.ll=f,a.mm=l+(c?" NULL":""),a.nn=f==="object"||f==="array")},oo:function(e){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/.test(e)?new Date(e):!1}},d._ss.tt={y:function(e){if(e==="string"||e==="text")return this.z;if(e==="int"||e==="integer"||e==="float")return this.aa;if(e==="object"||e==="array")return this.ee;if(e==="date")return this.bb;if(e==="time")return this.cc;if(e==="datetime")return this.dd;if(e==="boolean")return this.ff},z:function(e,t){return e||t},aa:function(e,t){return e-=0,e?e:t},bb:function(e,t){var n,r;return e instanceof Date?isNaN(e-0)?t:(n=e.getMonth()+1,r=e.getDate(),e.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)):(n=/^(\d{4}-\d{2}-\d{2})/.exec(e),n?n[1]:t)},cc:function(e,t){if(e instanceof Date)return isNaN(e-0)?t:e.toTimeString().substring(0,8);var n=/^(?:\d{4}-\d{2}-\d{2}(?: |T))?(\d{2}:\d{2})(?:(:\d{2})[^Z]+Z|(:\d{2}))?$/.exec(e);return n?n[1]+(n[2]||n[3]||":00"):t},dd:function(e,t){var n,r;return e instanceof Date?isNaN(e-0)?t:(n=e.getMonth()+1,r=e.getDate(),e.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)+" "+e.toTimeString().substring(0,8)):(n=/^(\d{4}-\d{2}-\d{2})(?: |T)(\d{2}:\d{2})(?:(:\d{2})[^Z]+Z|(:\d{2}))?$/.exec(e),n?n[1]+" "+n[2]+(n[3]||n[4]||":00"):t)},ee:function(e,t){if(typeof e=="undefined")return t;if(typeof e!="object")return e?e:t;try{return JSON.stringify(e)}catch(n){return t}},ff:function(e,t){return typeof e=="string"?(e=e.toLowerCase(),e==="true"||e==="1"?1:e==="false"||e==="0"?0:t):e===1?1:e===0?0:t},gg:function(e){return e}},d._ss.uu={y:function(e){if(e==="string"||e==="text")return this.z;if(e==="int"||e==="integer"||e==="float")return this.aa;if(e==="object"||e==="array")return this.ee;if(e==="date")return this.bb;if(e==="time")return this.cc;if(e==="datetime")return this.dd;if(e==="boolean")return this.ff},z:function(e,t){return e?e+"":t},aa:function(e,t){return e-=0,e?e:t},bb:function(e,t){var n,r;return e instanceof Date?isNaN(e-0)?t:e:(r=d._ss.oo(e))?r.toJSON():(n=/^(\d{4}-\d{2}-\d{2})/.exec(e),n?(n=n[1].split("-"),(new Date(n[0],n[1]-1,n[2],0,0,0,0)).toJSON()):t)},cc:function(e,t){var n,r;if(e instanceof Date)return isNaN(e-0)?t:e;if(r=d._ss.oo(e))return r.toJSON();n=/^(\d{4}-\d{2}-\d{2} )?(\d{2}:\d{2})(:\d{2})?$/.exec(e);if(!n)return t;var i,s,o;return n[1]?(i=n[1].split("-"),i[1]=i[1]-1):(i=new Date,i=[i.getFullYear(),i.getMonth(),i.getDate()]),s=n[2].split(":"),o=n[3]||0,(new Date(i[0],i[1],i[2],s[0],s[1],o,0)).toJSON()},dd:function(e,t){var n,r;if(e instanceof Date)return isNaN(e-0)?e:t;if(r=d._ss.oo(e))return r.toJSON();n=/^(\d{4}-\d{2}-\d{2})(?: |T)(\d{2}:\d{2})(?::(\d{2})[^Z]+Z|:(\d{2}))?$/.exec(e);if(!n)return t;var i,s,o;return i=n[1].split("-"),s=n[2].split(":"),o=n[3]||n[4]||0,(new Date(i[0],i[1]-1,i[2],s[0],s[1],o,0)).toJSON()},ee:function(e,t){if(typeof e=="undefined")return t;if(typeof e!="object"){if(!e)return t;if(typeof e=="string")try{return JSON.parse(e)}catch(n){return t}return e}return e},ff:function(e,t){return typeof e=="string"?(e=e.toLowerCase(),e==="true"||e==="1"?!0:e==="false"||e==="0"?!1:t):e===1?!0:e===0?!1:t},gg:function(e){return e}},d.ORM=function(n,r,i){typeof n=="string"&&(n={name:n});var o=n.name;if(!o)throw t;if(o===s)throw t;if(!/^[\w][-.\w\d]+$/i.test(o))throw t;return n.callback=n.callback||r||d._ss.b,n.context=n.context||i||e,d._b3.prototype=d._ss.s(n.prefered||""),new d._b3(n)},d._b3=function(e){var t=this._b4=e.name;this._a5=[],this._a6={},this._a7=[],this.Schema._b3=this,this._a8=!0,this._a9=[],this._b1=e.callback,this._b2=e.context,e.forceDestroy?this._e3(this._d6,this):this._d6()},d._c1=function(n,r,i){var s=n._b4,o=r.name;if(o==="__currents_ids__")throw t;if(!/^[\w][-\w\d]+$/i.test(o))throw t;if(n._a6[o]&&!i.forceDestroy)throw t;var u=r.fields;if(typeof u!="object"||!Object.keys(u).length)throw t;var a=r.primaryKey;if(!a||a&&!u[a])throw t;if(u[a].type!=="integer")throw t;u[a].allowNull=!0;var f,l,c=[],h=[];for(f in u){l=u[f];if(l.index){if(!/^(integer|float|string|date|time|datetime|boolean)$/.test(l.type))throw t;c.push(f),l.index=!0}else l.index=!1;l.unique?(c.indexOf(f)===-1&&(c.push(f),l.index=!0),h.push(f),l.unique=!0):l.unique=!1}n._a6[o]=this,this._b3=n,this._b4=o,this._b5=u,this._b6=c,this._b7=h,this._b8=a,this._b9=Object.keys(u),this._d4=i.forceDestroy,this._d5=this._d4?!1:i.forceEmpty,this._b1=i.callback||d._ss.b,this._b2=i.context||e},d._b3.c6={Schema:function(e){return d._ss.t(this.constructor._b3,d._c1.c6,e,"indexedDB",arguments)},_m5:{l5:function(e){var t=e.ORM,n=t._o3,r=n._b4;this.ORM=t,this.n3=0,this.n2=!1,this.n4=null,this.n5=null,this.m6=e.m6,this.m7=e.m7,this.m8=e.m8,this.n1=e.n1,e.n6?(this.n8=this.l3,this.n9=a,this.o1=this.l2,this.n7=r):(this.n8=this.l2,this.n9=r,this.o1=this.l3,this.n7=a),this.l4()},l3:function(){return this.ORM._m1()},l2:function(){return this.ORM._k6()},l4:function(){var e=this,t=e.ORM,r=e.n9,s=e.n8();s[f]=function(t){e.n5=this[i];var s=e.n5[n]([r],d._a3.READ_ONLY),o=s.objectStore(r),u=o.openCursor();u._m9=e,u[f]=e.l6},s[l]=t._k1},l6:function(e){var t=this._m9,n=t.n5,r=this[i];r?t.n2?(t.n2=!1,n.close(),t.l7(r.value)):t.n3===0?(t.n3++,n.close(),t.l7(r.value)):(t.n2=!0,r.advance(t.n3),t.n3++):(n.close(),t.l9())},l7:function(e){var t=this,r=t.ORM,s=t.n7,o=t.o1();o[f]=function(r){t.n4=this[i];var o=t.n4[n]([s],d._a3.READ_WRITE),u=o.objectStore(s),a=t.n1(u,e,t.n3);a._m9=t,a[f]=t.l8,a[l]=t.l8},o[l]=r._k1},l8:function(e){var t=this._m9;t.n4.close(),t.l4()},l9:function(){this.m6.call(this.m7,this.m8)}},_d6:function(){d._ss.pp();var e=this,t=this._b4,r=this._m1();r[c]=function(e){var t=this[i],n;n=t.createObjectStore(o,{keyPath:"id",autoIncrement:!0}),n.createIndex(u,u,{unique:!0}),t.createObjectStore(a)},r[f]=function(r){var s=this[i],a=s[n]([o],d._a3.READ_WRITE),l=a.objectStore(o);l.index(u).get(t)[f]=function(n){var r=this[i];if(!r)e._o4=0,l.add({name:t,branch:0,schemas:{}})[f]=function(t){s.close(),e._f2()};else{s.close();var o=r.branch;e._o4=o,e._f2()}}},r[l]=function(e){this._b1.call(this._b2,null)}},_f2:function(){d._ss.qq(),this._b1.call(this._b2,!0),this._d9()},_e3:function(t,r){var s=this,a=this._b4,c=d._a2.deleteDatabase(a);d._ss.pp(),c[f]=function(l){c=s._m1(),c[f]=function(l){var c=this[i],h=c[n]([o],d._a3.READ_WRITE),p=h.objectStore(o);p.index(u).get(a)[f]=function(n){var o=this[i];p.delete(o.id)[f]=function(n){c.close(),d._ss.r(s),d._ss.qq(),t.call(r||e,!0)}}}},c[l]=function(n){d._ss.qq(),t.call(r||e,!1)}},_d8:function(e){this._a9.push(e),this._a8||this._d9()},_d9:function(){var e=this,t=this._b4,r;this._a9.length?(d._ss.pp(),r=this._m1(),r[f]=function(r){var s=this[i],a=s[n]([o],d._a3.READ_WRITE),l=a.objectStore(o);l.index(u).get(t)[f]=function(t){var n=this[i];e._j8(s,l,n)}},r[l]=this._k1):this._e1()},_j8:function(e,t,n){var r=this,i=this._b4,s=this._a9.shift(),o=s._b4,u=n.schemas[o],a={fields:s._b5,primaryKey:s._b8};this._o3=s,u?s._d4?this._g1(this._g4):(e.close(),this._f6(u,a)?s._d5?this._g1(this._g4,this):this._f8():s._d5?this._g5():this._k3()):(this._j9(t,n),e.close(),this._f7())},_f6:function(e,t){var n=!1,r,i=e.fields,s=t.fields,o,u;for(r in i){o=i[r],u=s[r];if(!u||o.type!==u.type||o.index!==u.index||o.unique!==u.unique){n=!0;break}}var a=e.primaryKey,f=t.primaryKey;return!n&&(a&&(!f||a!==f)||!a&&f)&&(n=!0),n},_j9:function(e,t){var n=this._o3,r=n._b4,i=n._b8,s=n._c4;return t.schemas[r]={fields:s,primaryKey:i},req=e.put(t),req},_f7:function(){var e=this,t=this._o3,n=this._b4,r=t._b4,s=this._k5();s[c]=function(t){var n=this[i];e._k2(n)},s[f]=function(t){var n=this[i];n.close(),e._k4(e._k3,e)},s[l]=this._k1},_f8:function(){var e=this,t=this._m1();t[f]=function(t){var r=this[i],s=r[n]([a],d._a3.READ_WRITE),o=s.objectStore(a);o.clear()[f]=function(t){r.close(),e._f9()}},t[l]=this._k1},_f9:function(){var e=this,t=this._o3,n=t._b4,r=function(e,t,n){return e.add(t,n)};this._m5.l5({ORM:this,n6:!1,m6:this._g1,m7:this,m8:this._g2,n1:r})},_g1:function(e){var t=this,n=this._o3,r=n._b4,s=this._b4,o=this._k5();o[c]=function(e){var n=this[i];n.deleteObjectStore(r),t._k2(n)},o[f]=function(n){var r=this[i];r.close(),t._k4(e,t)},o[l]=this._k1},_g2:function(){var e=this,t=this._o3,n=t._b4,r=t._b5,i=function(e,t){var n,i;for(i in t)n=r[i],n?t[i]=n.ii(t[i],n.hh):delete t[i];return e.put(t)};this._m5.l5({ORM:this,n6:!0,m6:this._g3,m7:this,n1:i})},_g3:function(){var e=this,t=this._b4,r;r=this._m1(),r[f]=function(t){var r=this[i],s=r[n]([a],d._a3.READ_WRITE),o=s.objectStore(a);o.clear()[f]=function(t){r.close(),e._g4()}},r[l]=this._k1},_g4:function(){var e=this,t=this._b4,r=this._o3,s=r._b4,a;a=this._m1(),a[f]=function(r){var s=this[i],a=s[n]([o],d._a3.READ_WRITE),l=a.objectStore(o);l.index(u).get(t)[f]=function(t){var n=this[i],r;r=e._j9(l,n),r[f]=function(t){s.close(),e._g6()}}},a[l]=this._k1},_g5:function(){var e=this,t=this._b4,r=this._o3,s=r._b4,o;o=this._k6(),o[f]=function(t){var r=this[i],o=r[n]([s],d._a3.READ_WRITE),u=o.objectStore(s);u.clear()[f]=function(t){e._g6()}},o[l]=this._k1},_g6:function(){this._k3()},_k1:function(){this._k3(!1)},_k2:function(e){var t=this._o3,n=t._b5,r=t._b4,i=t._b8,s,o,u,a;a=e.createObjectStore(r,{keyPath:i,autoIncrement:!0});for(s in n)o=n[s],o.index&&(u=o.unique,a.createIndex(s,s,u?{unique:!0}:{}))},_k3:function(e){var t=this._o3,n=t._b1,r=t._b2;n.call(r,typeof e=="undefined"?!0:e),delete t._b1,delete t._b2,delete t._d4,delete t._d5,delete this._o3,d._ss.qq(),this._d9()},_e1:function(){this._a8=!1},_k4:function(t,r){var s=this,a=this._b4,l=this._o4,c;c=this._m1(),c[f]=function(s){var c=this[i],h=c[n]([o],d._a3.READ_WRITE),p=h.objectStore(o);p.index(u).get(a)[f]=function(n){var s=this[i];s.branch=l,p.put(s),c.close(),t&&t.call(r||e)}}},_k5:function(){var e=this._b4,t=this._o4+1;return this._o4=t,d._a2.open(e,t)},_k6:function(){var e=this._b4,t=this._o4;return d._a2.open(e,t)},_m1:function(){return d._a2.open(s,1)},_k7:function(t){t.d2||(t.d2=d._ss.b),t.d3||(t.d3=e),this._a5.push(t);if(this._c3)return;this._c3=!0,d._ss.pp(),this._k8()},_k8:function(){var e=this._a5.shift();e.type==="destroy"?this._g9(e):this._m2(e,this._exec2,this)},_exec2:function(e){var t=e.schema,n=e.type;this["_"+n](e)},_m2:function(e,t,r){var s=e.schema,o=this._k6();o[f]=function(o){var u=this[i],a=u[n]([s],d._a3[e.o9?"READ_ONLY":"READ_WRITE"]),f=a.objectStore(s);e.o7=f,e.o8=u,t.call(r,e)}},_e9:function(){this._c3=!1,this._a5.length&&this._k8()},_k9:function(e,t){d._ss.qq(),e.o8.close(),e.d2.call(e.d3,t),this._e9()},_put:function(e){var t=this,n=e.o7,r=e.data,s=0,o=r.length,u=function(n){s===o?t._k9(e,n):(c(),s++)},a=function(){t._k9(e,!1)},c=function(){var e=r[s],t=n.add(e);t[f]=function(e){u(this[i])},t[l]=function(e){a()}};u()},_set:function(e){var t=this,n=e.o7,s=e.data,o=e.o6,u=e.primaryKey,a=0,c=0,h=s.length,p=function(){c===h?t._k9(e,a):(v(),c++)},d=function(){t._k9(e,!1)},v=function(){var e=s[c],t=e.data,o=e.target,h=o[u],v,m=Object.keys(o).length;h?n.get(h)[f]=function(e){var r=this[i],s;if(r){for(v in t)r[v]=t[v];s=n.put(r),s[f]=function(e){this[i]&&a++,p()},s[l]=function(e){d()}}else p()}:n.openCursor()[f]=function(e){var n=this[i];if(n){var s=n.value,u=0,c;for(v in o)s[v]===o[v]&&u++;if(u===m){for(v in t)s[v]=t[v];c=n.update(s),c[f]=function(e){this[i]&&a++,n[r]()},c[l]=function(e){d()}}else n[r]()}else p()}};p()},_del:function(e){var t=this,n=e.o7;n.count()[f]=function(n){e.o5=this[i],t._m3(e)}},_m3:function(e){var t=this,n=e.data,r=e.primaryKey,i=e.o7,s=0,o=n.length,u=function(){s===o?t._m4(e):(a(),s++)},a=function(){var e=n[s];i.delete(e[r])[f]=function(e){u()}};u()},_m4:function(e){var t=this,n=e.o7;n.count()[f]=function(n){t._k9(e,e.o5-this[i])}},_empty:function(e){var t=this,n,r=e.o7;r.count()[f]=function(s){n=this[i],r.clear()[f]=function(r){t._k9(e,n)}}},_g9:function(e){var t=this,n=e.schema,r=this._k5();r[c]=function(e){var t=this[i];t.deleteObjectStore(n)},r[f]=function(n){var r=this[i];r.close(),t._l1(e)}},_l1:function(e){var t=this,r=this._b4,s=e.schema,a=this._a6[s],l=this._m1();l[f]=function(l){var c=this[i],h=c[n]([o],d._a3.READ_WRITE),p=h.objectStore(o);p.index(u).get(r)[f]=function(n){var r=this[i];delete r.schemas[s],p.put(r)[f]=function(n){t._k4(function(){e.o8=c,delete t._a6[s],d._ss.p(a),this._k9(e,!0)},t)}}}},_getAll:function(e){var t=this,n=e.d1,s=e.p6,o=e.p4,u=e.o7,a=[];u.openCursor()[f]=function(u){var f=this[i],l;f?(l=f.value,n(l,s,o)&&a.push(l),f[r]()):t._k9(e,a)}},_getWithRange:function(e){var t=this,n=e.p1,s=e.p2,o=e.p3,u=e.o7,a=[],l=function(n){var s=this[i];s?(a.push(s.value),s[r]()):t._k9(e,a)};n?u.openCursor(o)[f]=l:u.index(s).openCursor(o)[f]=l},batch:function(n,r,i){var s=this._b4,o;if(!Array.isArray(n)||!n.length)throw t;typeof r!="function"&&(r=d._ss.b),typeof i!="object"&&(i=e),o={data:n,d2:r,d3:i};if(this._c2){this._a7.push(o);return}this._c2=!0,this._f1(o)},_f1:function(n){var r=n.data,i=["set","put","del"],s=0,o=r.length,u,a,f,l;for(;s<o;s++){a=r[s],f=a.schema;if(!(f instanceof d._c1))throw t;l=a.type.toLowerCase();if(i.indexOf(l)===-1)throw t;u=f[l](a.data),u.d2=d._ss.b,u.d3=e,this._a5.push(u)}u=this._a5[this._a5.length-1],u.d2=n.d2,u.d3=n.d3,this._c2=!1,this._c3||this._e9()},destroy:function(e,t){this._e3(e||d._ss.a,t)}},d._c1.c6={_f2:function(){var e=this._b3,t=this._b5,n,r,i={};for(n in t)r=t[n],this._x(n),i[n]={type:r.type,index:r.index,unique:r.unique};this._c4=i,e._d8(this)},get:function(e,n,r){var i=this._b3,s=i._b4,o=this._b5,u,a={},f=this._b4,l;if(!e)throw t;for(u in o)a[u]=this._w(u,e);var c=function(e,t,n){for(var r in e)if(e[r]===n[r])return!0;return!1};l={type:"getAll",o9:!0,schema:f,d1:c,p4:a,d2:n,d3:r},i._k7(l)},getAll:function(e,t){var n=this._b3,r=n._b4,i=this._b4,s,o=function(){return!0};s={type:"getAll",o9:!0,schema:i,d1:o,d2:e,d3:t},n._k7(s)},getWithLike:function(e,n,r,i){var s=this._b3,o=s._b4,u=this._b5,a=this._b4,f,l,c,h,p,d;if(typeof n!="object")throw t;h=Object.keys(n)[0],p=n[h];if(!h||!p)throw t;h==="both"?p=new RegExp(p,"i"):h==="start"?p=new RegExp("^"+p,"i"):h==="end"&&(p=new RegExp(p+"$","i")),Array.isArray(e)||(e=[e]);for(f=0,l=e.length;f<l;f++){c=e[f];if(!u[c])throw t}var v=function(e,t,n){var r,i=0,s=t.length;for(;i<s;i++){r=t[i];if(n.test(e[r]))return!0}return!1};d={type:"getAll",o9:!0,schema:a,d1:v,p4:p,p6:e,d2:r,d3:i},s._k7(d)},getByCallback:function(e,n,r){var i=this._b3,s=i._b4,o=this._b4,u;if(typeof e!="function")throw t;u={type:"getAll",o9:!0,schema:o,d1:e,d2:n,d3:r},i._k7(u)},getByIndex:function(e,n,r,i){var s=this._b3,o=s._b4,u=this._b4,a={},f=[],l,c,h,p,v,m;if(this._b8!==e&&this._b6.indexOf(e)===-1)throw t;this._b8===e?a.pk=e:a.index=e;if(!n)throw t;Array.isArray(n)||(n=[n]);if(n.length===1)m={type:"getWithRange",o9:!0,schema:u,p1:a.pk,p2:a.index,p3:d._a4.only(this._w(e,n[0])),d2:r,d3:i};else{for(p=0,v=n.length;p<v;p++)c=n[p],h=this._w(e,c),f.push(h);l=function(e,t,n){for(var r=0,i=t.length;r<i;r++)if(t[r]===e[n])return!0;return!1},m={type:"getAll",o9:!0,schema:u,d1:l,p4:a.pk||a.index,p6:f,d2:r,d3:i}}s._k7(m)},getByIndexWithRange:function(e,n,r,i){var s=this._b3,o=s._b4,u=this._b4,a=this._b5,f=/^(?:>|<|>=|<=|=)$/,l,c={},h={},p,v,m=a[e],g,y,b;if(this._b8!==e&&this._b6.indexOf(e)===-1)throw t;this._b8===e?c.pk=e:c.index=e,g=n["="],g&&m.kk&&(n={">=":g,"<=":g});for(l in n){if(!f.test(l))throw t;g=n[l],y=this._w(e,g);if(!y&&y!==m.hh)throw t;h[l]=y}p=Object.keys(h).length;if(p===2)try{h[">"]&&h["<"]?v=d._a4.bound(h[">"],h["<"],!0,!0):h[">="]&&h["<="]?v=d._a4.bound(h[">="],h["<="]):h[">"]&&h["<="]?v=d._a4.bound(h[">"],h["<="],!0,!1):v=d._a4.bound(h[">="],h["<"],!1,!0)}catch(w){throw t}else p===1&&(h[">"]?v=d._a4.lowerBound(h[">"],!0):h[">="]?v=d._a4.lowerBound(h[">="]):h["<"]?v=d._a4.upperBound(h["<"],!0):h["<="]?v=d._a4.upperBound(h["<="]):v=d._a4.only(h["="]));if(!v)throw t;c.keyRange=v,b={type:"getWithRange",o9:!0,schema:u,p1:c.pk,p2:c.index,p3:v,d2:r,d3:i},s._k7(b)},put:function(e,t,n){var r=this._b3,i=r._b4,s=this._b9,o,u=this._b8,a=this._b4,f,l,c,h,p=s.length,d;!Array.isArray(e)&&typeof e=="object"&&(e=[e]);for(l=0,c=e.length;l<c;l++){f=e[l];for(h=0;h<p;h++)o=s[h],f[o]=this._w(o,f[o]);f[u]<=0&&delete f[u]}d={type:"put",schema:a,primaryKey:u,data:e,d2:t,d3:n};if(r._c2)return d;r._k7(d)},set:function(e,n,r){var i=this._b3,s=this._b4,o=this._b5,u=i._b4,a,f,l,c,h,p,d,v={},m={},g=[],y,b,w;if(!e||typeof e!="object")throw t;Array.isArray(e)||(e=[e]);for(y=0,b=e.length;y<b;y++){f=e[y];if(!f.data||typeof f.data!="object"||!Object.keys(f.data).length)throw t;if(f.target){if(typeof f.target!="object"||!Object.keys(f.target).length)throw t}else f.target=[];c=f.target;for(p in c){d=c[p],l=this._w(p,d);if(!l&&l!==o[p].hh)throw t;v[p]=l}h=f.data;for(p in h){d=h[p],l=this._w(p,d);if(!l&&l!==o[p].hh)throw t;m[p]=l}g.push({data:m,target:v}),m={},v={}}w={type:"set",schema:s,o6:this._b6,primaryKey:this._b8,data:g,d2:n,d3:r};if(i._c2)return w;i._k7(w)},del:function(e,n,r){var i=this._b3,s=i._b4,o=this._b8,u=this._b4,a,f,l,c=[],h,p,d;if(!o)throw t;if(!e)throw t;Array.isArray(e)||(e=[e]);for(h=0,p=e.length;h<p;h++){a=e[h],f=this._w(o,a);if(!f)throw t;l={},l[o]=f,c.push(l)}d={type:"del",schema:u,primaryKey:o,data:c,d2:n,d3:r};if(i._c2)return d;i._k7(d)},destroy:function(e,t){var n=this._b3,r=n._b4,i=this._b4;n._k7({type:"destroy",schema:i,d2:e,d3:t})},empty:function(e,t){var n=this._b3,r=n._b4,i=this._b4;n._k7({type:"empty",schema:i,d2:e,d3:t})}},d._b3.c7={Schema:function(e){return d._ss.t(this.constructor._b3,d._c1.c7,e,"webSQL",arguments)},_d6:function(){(function(t){d._ss.pp(),t._h4=e.openDatabase(s,1,"",d._ss.vv),t._h4[n](function(e){e[h]("CREATE TABLE IF NOT EXISTS databases( id INTEGER PRIMARY KEY, name TEXT UNIQUE, schemas TEXT )"),e[h]('SELECT * FROM databases WHERE name = "'+t._b4+'"',[],function(e,n){t._d7(n)})})})(this)},_d7:function(t){var r=t.rows;this._h5=r.length?JSON.parse(r.item(0).schemas):{},this._h6=[],this._h7=e.openDatabase(this._b4,1,"",d._ss.vv),function(e){e._h7[n](function(e){e[h]("CREATE TABLE IF NOT EXISTS __currents_ids__( id INTEGER PRIMARY KEY, table_name TEXT UNIQUE, last_id INTEGER )")},null,function(){d._ss.qq(),e._b1.call(e.initContext,!0),e._d9()})}(this)},_d8:function(e){this._a9.push(e),this._a8||(this._a8=!0,this._d9())},_d9:function(){var e=this,t,n=this._b4;this._a9.length?(d._ss.pp(),t=this._a9.shift(),t._f3()):(d._ss.qq(),this._e1())},_e1:function(){this._a8=!1},_e2:function(e,t,r){var i=this,s=this._b4,o=this._h5;this._h4[n](function(e){e[h]('REPLACE INTO databases( name, schemas ) VALUES( "'+s+'", '+"'"+JSON.stringify(o)+"'"+")")},null,function(){e.call(t,r)})},_e3:function(e,t){this.destroy(e,t)},_e4:function(e,t){var r=this,i=e._b4;delete this._a6[i],delete this._h5[i],d._ss.p(e),this._h7[n](function(e){e[h]("DELETE FROM"+p+'WHERE table_name = "'+i+'"')},null,function(){r._e2(t.d2,t.d3,!0)})},_e5:function(e){},_e6:function(t){var n=t.d2,r=t.d3;n||(t.d2=d._ss.b),r||(t.d3=e);if(this._c3){t.j3?this._h6.push(t):this._a5.push(t);return}this._c3=!0,d._ss.pp(),this._e7(t)},_e7:function(e){this._h8=e;var t=this,r=0,i=e.h9;Array.isArray(i)||(i=[i]);var s=e.i2?function(e,t){r+=t.rowsAffected}:d._ss.a,o=function(n,i){e.i2?e.returnValue=i.rowsAffected+r:e.i4?e.returnValue=i.insertId:e.i3&&(e.returnValue=i.rowsAffected),t._e8(i)},u=function(e){t._e5(e),t._e8(!1)};this._h7[n](function(t){var n,r=i.length;while(r--)n=i.shift(),t[h](n,e.i1?e.i1.shift():[],r?s:o)},u)},_e8:function(e){var t=this._h8;this._c3=!1,e||(t.returnValue=!1),t.j4?t.j4.call(t.j5,e,t):t.d2.call(t.d3,t.returnValue),this._e9()},_e9:function(){d._ss.qq(),this._c3||(this._h6.length?this._e6(this._h6.shift()):this._a5.length&&!this._a8&&this._e6(this._a5.shift()))},batch:function(n,r,i){var s=this._b4,o;if(!Array.isArray(n)||!n.length)throw t;r||(r=d._ss.b),i||(i=e),o={data:n,callback:r,context:i};if(this._c2){this._a7.push(o);return}this._c2=!0,this._f1(o)},_f1:function(e){var n=e.data,r=["set","put","del"],i,s,o,u=0,a=n.length;for(;u<a;u++){i=n[u],s=i.schema;if(!(s instanceof d._c1))throw t;o=i.type.toLowerCase();if(r.indexOf(o)===-1)throw t;this._a5.push(s[o](i.data))}var f=this._a5[this._a5.length-1];f.d2=e.callback,f.d3=e.context,this._c2=!1,this._e9(),this._a7.length&&this._f1(this._a7.shift())},destroy:function(t,n){(t||d._ss.a).call(n||e,!1)}},d._c1.c7={_f2:function(){var e=this._b5,t,n,r=this._b3,i=r._b4,s=this._b4,o=[],u=this._b8,a,f={},l,c,h={};for(n in e)t=e[n],a=[],u===n?a.push("PRIMARY KEY"):(l=t.index,c=t.unique,l&&c?f[n]=!0:l&&(f[n]=!1)),this._x(n),h[n]={type:t.type,index:t.index,unique:t.unique},o.push(n+" "+e[n].mm+(a.length?" "+a.join(" "):""));this._i5='CREATE TABLE "'+s+'" ( '+o.join(", ")+" )",this._c4=h,this._j7=f,this._i7=[],r._d8(this)},_f3:function(){var e=this._b3,t=e._b4,n=this._b4,r,i,s;this._d4?(r="DROP TABLE IF EXISTS "+n,e._e6({h9:r,j5:this,j4:this._f7,j3:!0})):(s={fields:this._c4,primaryKey:this._b8},i=e._h5[n],i?this._f6(i,s):(e._h5[n]=s,this._b3._e2(this._f7,this)))},_f4:function(e,t,n){return"CREATE UNIQUE INDEX "+this._h3(e,t)+" ON "+(n||e)+" ( "+t+" )"},_f5:function(e,t,n){return"CREATE INDEX "+this._h3(e,t)+" ON "+(n||e)+" ( "+t+" )"},_h3:function(e,t){return e+"_"+t},_f6:function(e,t){var n=this._b3,r=n._b4,i=this._b4,s=!1,o=e.fields,u=t.fields,a,f,l;for(l in o){a=o[l],f=u[l];if(!f||a.type!==f.type||a.unique!==f.unique){s=!0;break}}var c=e.primaryKey,h=t.primaryKey;!s&&(c&&(!h||c!==h)||!c&&h)&&(s=!0);if(s)n._h5[i]=t,this._b3._e2(this._f8,this);else{var p=[],d=this._b6,v=this._j7;for(l in o)a=o[l],a.index&&(d.indexOf(l)===-1?p.push(l):delete v[l]);p.length||Object.keys(v).length?(this._i7=p,n._h5[i]=t,this._b3._e2(this._h2,this)):this._d5?this._h1():this._g6()}},_f7:function(){var e=this._b3,t=this._b4,n=e._b4,r=this._b8,i,s;i="CREATE TRIGGER IF NOT EXISTS update_last_id_on_"+t+" AFTER INSERT ON "+t+" BEGIN "+" UPDATE"+p+"SET last_id = ( "+" SELECT CASE "+" WHEN ( SELECT 1 WHERE NEW.rowid >= ( SELECT last_id FROM"+p+'WHERE table_name = "'+t+'" ) )'+" THEN NEW.rowid "+" WHEN ( SELECT 1 WHERE NEW.rowid < ( SELECT last_id FROM"+p+'WHERE table_name = "'+t+'" ) )'+" THEN ( SELECT last_id - 1 FROM"+p+'WHERE table_name = "'+t+'" ) '+" ELSE "+" ( SELECT last_id FROM"+p+'WHERE table_name = "'+t+'" ) '+" END "+' ) + 1 WHERE table_name = "'+t+'" ; '+" END ",s="REPLACE INTO"+p+'VALUES( null, "'+t+'", 1 )',e._e6({h9:[this._i5,i,s],j5:this,j4:this._h2,j3:!0})},_f8:function(){var e=this._b3,t=this._i5,n=this._b4,r=n+ +(new Date),i=t.replace('CREATE TABLE "'+n+'"','CREATE TABLE "'+r+'"');this._i8=0,this._i9=r,e._e6({h9:i,j5:this,j4:this._f9,j3:!0})},_f9:function(){var e=this._b3,t=e._b4,n=this._b4,r=this._i9,i=[],s=this._j7,o;for(o in s)i.push("DROP INDEX IF EXISTS "+this._h3(n,o)),s[o]?i.push(this._f4(n,o,r)):i.push(this._f5(n,o,r));i.length?e._e6({h9:i,j5:this,j4:this._g1,j3:!0}):this._g1()},_g1:function(){var e=this._b3,t=this._b4,n=this._i9,r=this._i8,i;this._d5?(this._j6=!0,this._g6()):this._d4?this._g5():this._g2()},_g2:function(){var e=this._b3,t=this._b4,n=this._i9,r="SELECT * FROM "+t+" LIMIT "+this._i8+", 500";e._e6({h9:r,j5:this,j4:this._g3,j3:!0})},_g3:function(e){var t=this._b3,n=this._b5,r=this._b4,i=this._i9,s=e.rows,o,u,a,f=[],l,c=[],h=[],p=[],d=[],v,m,g,y;if(!s.length)this._g4();else{o=s.item(0);for(u in o)n[u]&&f.push(u);for(u in n)a=n[u],f.indexOf(u)===-1&&(f.push(u),h.push(a.hh),c.push("?"));for(m=0,g=s.length;m<g;m++){v=[],l=[],o=s.item(m);for(u in o)a=n[u],a&&(l.push("?"),a.nn?v.push(o[u]):v.push(a.ii(o[u],a.hh)));p.push("INSERT INTO "+i+" ( "+f.join(", ")+" ) VALUES ( "+l.concat(c).join(", ")+" )"),d.push(v.concat(h))}y={h9:p,i1:d,j5:this,j3:!0},g===500?(this._i8+=500,y.j4=this._g2):y.j4=this._g4,t._e6(y)}},_g4:function(){var e=this._b3,t=this._b4,n="DROP TABLE "+t,r=this._i9,i="ALTER TABLE "+r+" RENAME TO "+t;e._e6({h9:[n,i],j5:this,j4:this._g5,j3:!0})},_g5:function(){var e=this._b3;this._d5&&!this._j6?this._h1():this._g6()},_g6:function(){delete this._i5,delete this._j7,delete this._j6,delete this._i9,delete this._i8,delete this._i7,delete this._d4,delete this._d5,this._b1.call(this._b2,!0),delete this._b1,delete this._b2,this._b3._d9()},_h1:function(){var e=this._b3,t=e._b4,n=this._b4,r="DELETE FROM "+n;e._e6({h9:[r],j5:this,j4:this._g6,j3:!0})},_h2:function(){var e=this._b3,t=this._b4,n=[],r=this._i7,i=this._j7,s;while(r.length)n.push("DROP INDEX "+this._h3(t,r.shift()));for(s in i)i[s]?n.push(this._f4(t,s)):n.push(this._f5(t,s));n.length?e._e6({h9:n,j5:this,j4:this._g5,j3:!0}):this._g5()},get:function(e,n,r){var i=this._b3,s=this._b5,o,u=i._b4,a=this._b4,f,l=[],c=[];if(!e)throw t;for(o in s)l.push(o+" = ?"),c.push(this._w(o,e));f="SELECT * FROM "+a+" WHERE "+l.join(" OR "),i._e6({h9:f,i1:[c],j4:this._g8,j5:this,d2:n,d3:r})},getByCallback:function(e,n,r){var i=this._b3,s=this._b5,o,u=this._b4,a;if(typeof e!="function")throw t;a="SELECT * FROM "+u,i._e6({h9:a,j5:this,j4:this._g7,d2:n,d3:r,d1:e})},_g7:function(e,t){var n=this._b5,r=e.rows,i=0,s=r.length,o,u,a=t.d1,f,l=[];for(;i<s;i++){o=r.item(i),f={};for(u in o)f[u]=n[u].jj(o[u]);a(f)&&l.push(f)}t.d2.call(t.d3,l)},getByIndex:function(e,n,r,i){var s=this._b3,o=s._b4,u=this._b4,a,f=[],l=[],c,h,p,d;if(this._b8!==e&&this._b6.indexOf(e)===-1)throw t;if(!n)throw t;Array.isArray(n)||(n=[n]);for(p=0,d=n.length;p<d;p++)c=n[p],h=this._w(e,c),f.push(e+" = ?"),l.push(h);a="SELECT * FROM "+u+(f.length?" WHERE "+f.join(" OR "):""),s._e6({h9:a,i1:[l],j5:this,j4:this._g8,d2:r,d3:i})},getByIndexWithRange:function(e,n,r,i){var s=this._b3,o=s._b4,u=this._b4,a=this._b5,f=/^(?:>|<|>=|<=|=)$/,l,c=[],h,p,d=[],v;if(this._b8!==e&&this._b6.indexOf(e)===-1)throw t;for(l in n){if(!f.test(l))throw t;h=n[l],p=this._w(e,h);if(!p&&p!==a[e].hh)throw t;c.push(e+" "+l+" ?"),d.push(p)}if(!c.length)throw t;v="SELECT * FROM "+u+" WHERE "+c.join(" AND "),s._e6({h9:v,i1:[d],j5:this,j4:this._g8,d2:r,d3:i})},getAll:function(e,t){var n=this._b3,r=this._b4,i="SELECT * FROM "+r;n._e6({h9:i,j5:this,j4:this._g8,d2:e,d3:t})},getWithLike:function(e,n,r,i){var s=this._b3,o=s._b4,u=this._b5,a=this._b4,f,l,c,h,p,d=[],v,m=[];if(typeof n!="object")throw t;h=Object.keys(n)[0],p=n[h];if(!h||!p)throw t;h==="both"?p="%"+p+"%":h==="start"?p+="%":h==="end"&&(p="%"+p),Array.isArray(e)||(e=[e]);for(f=0,l=e.length;f<l;f++){c=e[f];if(!u[c])throw t;m.push(c+" LIKE ?"),d.push(p)}v="SELECT * FROM "+a+" WHERE "+m.join(" OR "),s._e6({h9:v,i1:[d],j5:this,j4:this._g8,d2:r,d3:i})},_g8:function(e,t){var n=this._b5,r=e.rows,i=0,s=r.length,o,u,a,f=[];for(;i<s;i++){o=r.item(i),a={};for(u in o)a[u]=n[u].jj(o[u]);f.push(a)}t.d2.call(t.d3,f)},put:function(e,t,n){var r=this._b3,i=r._b4,s=this._b9,o,u,a=this._b4,f=this._b8,l,c=[],h,d,v=[],m,g,y,b,w=s.length,E;!Array.isArray(e)&&typeof e=="object"&&(e=[e]);for(g=0,y=e.length;g<y;g++){m=e[g],l=[],h=[],d=[];for(b=0;b<w;b++)o=s[b],l.push(o),u=this._w(o,m[o]),o===f&&(!u||u<=0)?d.push("( SELECT last_id FROM"+p+'WHERE table_name = "'+a+'" )'):(h.push(u),d.push("?"));c.push(h),v.push("INSERT OR ROLLBACK INTO "+a+" ( "+l.join(", ")+" ) "+"VALUES ( "+d.join(" , ")+" )")}E={h9:v,i1:c,d2:t,d3:n,i4:!0};if(r._c2)return E;r._e6(E)},set:function(e,n,r){var i=this._b3,s=this._b4,o=i._b4,u=this._b5,a,f,l,c,h,p,d,v,m,g=[],y,b=[],w,E,S;if(!e||typeof e!="object")throw t;Array.isArray(e)||(e=[e]);for(w=0,E=e.length;w<E;w++){f=e[w],y=[],m=[],v=[];if(!f.data||typeof f.data!="object"||!Object.keys(f.data).length)throw t;if(f.target){if(typeof f.target!="object"||!Object.keys(f.target).length)throw t}else f.target=[];h=f.data;for(p in h){d=h[p],l=this._w(p,d);if(!l&&l!==u[p].hh)throw t;m.push(p+" = ?"),y.push(l)}c=f.target;for(p in c){d=c[p],l=this._w(p,d);if(!l&&l!==u[p].hh)throw t;v.push(p+" = ?"),y.push(l)}b.push("UPDATE OR ROLLBACK "+s+" SET "+m.join(", ")+(v.length?" WHERE "+v.join(" AND "):"")),g.push(y)}S={h9:b,i1:g,i2:!0,d2:n,d3:r};if(i._c2)return S;i._e6(S)},del:function(e,n,r){var i=this._b3,s=i._b4,o=this._b8,u=this._b4,a,f,l,c=[],h,p,d;if(!o)throw t;if(!e)throw t;Array.isArray(e)||(e=[e]);for(h=0,p=e.length;h<p;h++){a=e[h],f=this._w(o,a);if(!f)throw t;c.push(o+" = "+f)}l="DELETE FROM "+u+(c.length?" WHERE "+c.join(" OR "):""),d={h9:l,i3:!0,d2:n,d3:r};if(i._c2)return d;i._e6(d)},destroy:function(e,t){var n=this._b3,r=this._b4,i="DROP TABLE "+r;n._e6({j4:this._g9,j5:this,h9:i,d2:e,d3:t})},_g9:function(e,t){var n=this._b3;e&&n._e4(this,t)},empty:function(e,t){var n=this._b3,r=this._b4,i="DELETE FROM "+r;n._e6({h9:i,i3:!0,d2:e,d3:t})}},e.MSQTA=d})(window);