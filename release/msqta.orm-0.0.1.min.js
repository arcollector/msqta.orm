var MSQTA=MSQTA||{};MSQTA._rr=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,MSQTA._ss=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction;if(!MSQTA._ss.READ_WRITE||!MSQTA._ss.READ_ONLY)MSQTA._ss.READ_WRITE="readwrite",MSQTA._ss.READ_ONLY="readonly";MSQTA._tt=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange,MSQTA._ii={a:function(){},b:function(){},ll:2097152,c:function(e){return e==="object"||e==="array"?this.d:e==="datetime"?this.h:e==="date"?this.e:e==="time"?this.g:e==="boolean"?this.i:this.j},d:function(e){return JSON.parse(e)},e:function(e){var t=e.split("-");return new Date(t[0],t[1]-1,t[2],0,0,0,0)},e:function(e){var t=new Date,n=e.split(":");return t.setHours(n[0]),t.setMinutes(n[1]),t.setSeconds(n[2]),t},h:function(e){var t=e.split(" "),n=t[0].split("-"),r=t[1].split(":");return new Date(n[0],n[1]-1,n[2],r[0],r[1],r[2],0)},i:function(e){return!!e},j:function(e){return e},qq:["batch","destroy"],pp:["del","destroy","empty","get","getAll","getWithLike","getByCallback","getByIndex","getByIndexWithRange","put","set"],k:function(e){var t=this.pp,n=this.a,r,i;for(r=0,i=t.length;r<i;r++)e[t[r]]=n},l:function(e){var t=this.qq,n=this.pp,r,i,s,o=this.a,u,a;for(u=0,a=t.length;u<a;u++)e[t[u]]=o;s=e._vv;for(r in s){i=s[r];for(u=0,a=n.length;u<a;u++)i[n[u]]=o}},m:function(e){e=e.toLowerCase();if(e==="websql"){if(window.openDatabase)return MSQTA._a2.WebSQL}else if(e==="indexeddb"&&MSQTA._rr)return MSQTA._a2.IndexedDB;if(window.openDatabase)return MSQTA._a2.WebSQL;if(MSQTA._rr)return MSQTA._a2.IndexedDB},n:function(e){var t=e.ORM,n=e.schemaPrototype,r=e.implementation,i=e.schemaDefinition,s=e.args,o={},u;if(!t)throw Error("MSQTA-ORM!");return typeof s[1]=="function"?(o.callback=s[1],o.context=s[2]||window):typeof s[1]=="object"&&(o=s[1]),MSQTA._a9.prototype=n,u=new MSQTA._a9(t,i,o),u._r=MSQTA._ii.p,u._q=MSQTA._ii.o,u._b4=r,u._d3(),u},o:function(e,t){var n=this._a4,r=this._a3,i=n[e];if(!i)throw Error("MSQTA-ORM!");return i.cc(t,i.bb)},mm:{string:"TEXT",integer:"INTEGER",object:"TEXT",array:"TEXT",date:"DATE",time:"TIME",datetime:"DATETIME","float":"REAL","boolean":"INTEGER"},nn:{string:"",integer:0,object:"{}",array:"[]",date:"0000-00-00",time:"00:00:00",datetime:"0000-00-00 00:00:00","float":0,"boolean":0},oo:{string:"","int":0,integer:0,text:"",object:{},array:[],date:new Date(0,0,0),time:new Date(0,0,0),datetime:new Date(0,0,0),"float":0,"boolean":!1},p:function(e){var t=this._b4,n=MSQTA._ii.mm,r=t==="webSQL"?MSQTA._ii.nn:MSQTA._ii.oo,i=this._a3,s=this._a2._a3,o=this._a4[e],u,a=o.type,f=n[a],l=o.allowNull;if(!f)throw Error("MSQTA-ORM!");u=this._a4[e],u.bb=l?t==="webSQL"?null:null:r[a],u.cc=t==="webSQL"?MSQTA._ii.jj.s(a):MSQTA._ii.kk.s(a),u.dd=MSQTA._ii.c(a),u.ee=a==="date"||a==="time"||a==="datetime",t==="webSQL"&&(u.ff=a,u.gg=f+(l?" NULL":""),u.hh=a==="object"||a==="array")}},MSQTA._ii.jj={s:function(e){if(e==="string"||e==="text")return this.t;if(e==="int"||e==="integer"||e==="float")return this.u;if(e==="object"||e==="array")return this.y;if(e==="date")return this.v;if(e==="time")return this.w;if(e==="datetime")return this.x;if(e==="boolean")return this.z},t:function(e,t){return e||t},u:function(e,t){return e-=0,e?e:t},v:function(e,t){var n,r;return e instanceof Date&&+e>=0?(n=e.getMonth()+1,r=e.getDate(),e.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)):(n=/^(\d{4}-\d{2}-\d{2})(?: \d{2}:\d{2}(?::\d{2}))?$/.exec(e),n?n[1]:t)},w:function(e,t){if(e instanceof Date&&+e>=0)return e.toTimeString().substring(0,8);var n=/^(?:\d{4}-\d{2}-\d{2} )?(\d{2}:\d{2})(:\d{2})?$/.exec(e);return n?n[1]+(n[2]||":00"):t},x:function(e,t){var n,r;return e instanceof Date&&+e>=0?(n=e.getMonth()+1,r=e.getDate(),e.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)+" "+e.toTimeString().substring(0,8)):(n=/^(\d{4}-\d{2}-\d{2})(?: |T)(\d{2}:\d{2})(?:(:\d{2})[^Z]+Z|(:\d{2}))?$/.exec(e),n?n[1]+" "+n[2]+(n[3]||n[4]||":00"):t)},y:function(e,t){if(typeof e=="undefined")return t;if(typeof e!="object")return e?typeof e=="string"?"'"+e+"'":e:t;try{return JSON.stringify(e)}catch(n){return t}},z:function(e,t){return typeof e=="string"?(e=e.toLowerCase(),e==="true"||e==="1"?1:e==="false"||e==="0"?0:t):e===1?1:e===0?0:t},aa:function(e){return e}},MSQTA._ii.kk={s:function(e){if(e==="string"||e==="text")return this.t;if(e==="int"||e==="integer"||e==="float")return this.u;if(e==="object"||e==="array")return this.y;if(e==="date")return this.v;if(e==="time")return this.w;if(e==="datetime")return this.x;if(e==="boolean")return this.z},t:function(e,t){return e?e+"":t},u:function(e,t){return e-=0,e?e:t},v:function(e,t){var n,r;return e instanceof Date&&!isNaN(e-0)?(e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e):(n=/^(\d{4}-\d{2}-\d{2})(?: \d{2}:\d{2}(?::\d{2}))?$/.exec(e),n?(n=n[1].split("-"),new Date(n[0],n[1]-1,n[2],0,0,0,0)):t)},w:function(e,t){if(e instanceof Date&&!isNaN(e-0))return e;var n=/^(\d{4}-\d{2}-\d{2} )?(\d{2}:\d{2})(:\d{2})?$/.exec(e);if(!n)return t;var r,i,s;return n[1]?(r=n[1].split("-"),r[1]=r[1]-1):(r=new Date,r=[r.getFullYear(),r.getMonth(),r.getDate()]),i=n[2].split(":"),s=n[3]||0,new Date(r[0],r[1],r[2],i[0],i[1],s,0)},x:function(e,t){var n,r;if(e instanceof Date&&!isNaN(e-0))return e;n=/^(\d{4}-\d{2}-\d{2})(?: |T)(\d{2}:\d{2})(?::(\d{2})[^Z]+Z|:(\d{2}))?$/.exec(e);if(!n)return t;var i,s,o;return i=n[1].split("-"),s=n[2].split(":"),o=n[3]||n[4]||0,new Date(i[0],i[1]-1,i[2],s[0],s[1],o,0)},y:function(e,t){return typeof e=="undefined"?t:typeof e!="object"?e?typeof e=="string"?"'"+e+"'":e:t:e},z:function(e,t){return typeof e=="string"?(e=e.toLowerCase(),e==="true"||e==="1"?!0:e==="false"||e==="0"?!1:t):e===1?!0:e===0?!1:t},aa:function(e){return e}},MSQTA.ORM=function(e,t,n){typeof e=="string"&&(e={name:e});if(!e.name)throw Error("MSQTA-ORM!");return e.callback=typeof t=="function"?t:MSQTA._ii.b,e.context=n||window,MSQTA._a2.prototype=MSQTA._ii.m(e.prefered||""),new MSQTA._a2(e)},MSQTA._a2=function(e){var t=this._a3=e.name;this.forceDestroy=e.forceDestroy,this._uu=[],this._vv={},this._ww=[],this.Schema._a2=this,this._xx=!0,this._yy=[],this._zz=e.callback,this._a1=e.context,this.forceDestroy?this._c2(this._b5,this):this._b5()},MSQTA._a9=function(e,t,n){var r=e._a3,i=t.name;if(e._vv[i]&&!n.forceDestroy)throw Error("MSQTA-ORM!");var s=t.fields;if(typeof s!="object"||!Object.keys(s).length)throw Error("MSQTA-ORM!");var o=t.primaryKey;if(!o||o&&!s[o])throw Error("MSQTA-ORM!");if(s[o].type!=="integer")throw Error("MSQTA-ORM!");s[o].allowNull=!0;var u,a,f=[],l=[];for(u in s){a=s[u];if(a.index){if(!/^(integer|float|string|date|time|datetime)$/.test(a.type))throw Error("MSQTA-ORM!");f.push(u)}else a.index=!1;a.unique?(f.indexOf(u)===-1&&f.push(u),l.push(u)):a.unique=!1}e._vv[i]=this,this._a2=e,this._a3=i,this._a4=s,this._a5=f,this._a6=l,this._a7=o,this._a8=Object.keys(s),this.forceDestroy=n.forceDestroy,this.forceEmpty=this.forceDestroy?!1:n.forceEmpty,this._zz=typeof n.callback=="function"?n.callback:MSQTA._ii.b,this._a1=n.context||window},MSQTA._a2.IndexedDB={Schema:function(e){return MSQTA._ii.n({ORM:this.constructor._a2,schemaPrototype:MSQTA._a9.IndexedDB,schemaDefinition:e,implementation:"indexedDB",args:arguments})},_b5:function(){var e=this,t=this._a3,n=MSQTA._rr.open("__msqta__",1);n.onupgradeneeded=function(e){var t=e.target.result,n;n=t.createObjectStore("databases",{keyPath:"id",autoIncrement:!0}),n.createIndex("name","name",{unique:!0}),t.createObjectStore("dump")},n.onsuccess=function(n){var r=n.target.result,i=r.transaction(["databases"],MSQTA._ss.READ_WRITE),s=i.objectStore("databases");s.index("name").get(t).onsuccess=function(n){var i=n.target.result;if(!i)e._currentBranch=0,s.add({name:t,branch:0,schemas:{}}).onsuccess=function(t){r.close(),e._d3()};else{r.close();var o=i.branch;e._currentBranch=o,e._d3()}}},n.onerror=function(e){this._zz.call(this._a1,null)}},_d3:function(){this._zz.call(this._a1,!0),this._b8()},_c2:function(e,t){var n=this,r=this._a3,i=MSQTA._rr.deleteDatabase(r);i.onsuccess=function(s){i=MSQTA._rr.open("__msqta__"),i.onsuccess=function(i){var s=i.target.result,o=s.transaction(["databases"],MSQTA._ss.READ_WRITE),u=o.objectStore("databases");u.index("name").get(r).onsuccess=function(r){var i=r.target.result;u.delete(i.id).onsuccess=function(r){s.close(),MSQTA._ii.l(n),e.call(t||window,!0)}}}},i.onerror=function(n){e.call(t||window,!1)}},_b7:function(e){this._yy.push(e),this._xx||this._b8()},_b8:function(){var e=this,t=this._a3,n;this._yy.length?(n=MSQTA._rr.open("__msqta__",1),n.onsuccess=function(n){var r=n.target.result,i=r.transaction(["databases"],MSQTA._ss.READ_WRITE),s=i.objectStore("databases");s.index("name").get(t).onsuccess=function(t){var n=t.target.result;e._h5(r,s,n)}},n.onerror=this._h7):this._b9()},_h5:function(e,t,n){var r=this,i=this._a3,s=this._yy.shift(),o=s._a3,u=n.schemas[o],a={fields:s._a4,primaryKey:s._a7};this._currentSchema=s,u?s.forceDestroy?this._e2(this._e5):s.forceEmpty?this._e6():(e.close(),this._d7(u,a)?this._d9():this._h9()):(this._h6(t,n),e.close(),this._d8())},_d7:function(e,t){var n=!1,r=e.fields,i=t.fields,s,o;for(fieldName in r){s=r[fieldName],o=i[fieldName];if(!o||s.type!==o.type||s.index!==o.index||s.unique!==o.unique){n=!0;break}}var u=e.primaryKey,a=t.primaryKey;return!n&&(u&&(!a||u!==a)||!u&&a)&&(n=!0),n},_h6:function(e,t){var n=this._currentSchema,r=n._a3,i=n._a7,s=n._b3;return t.schemas[r]={fields:s,primaryKey:i},req=e.put(t),req},_d8:function(){var e=this,t=this._currentSchema,n=this._a3,r=t._a3,i=this._i2();i.onupgradeneeded=function(t){var n=t.target.result;e._h8(n)},i.onsuccess=function(t){var n=t.target.result;n.close(),e._i1(e._h9,e)},i.onerror=this._h7},_d9:function(){var e=this,t=MSQTA._rr.open("__msqta__",1);t.onsuccess=function(t){var n=t.target.result,r=n.transaction(["dump"],MSQTA._ss.READ_WRITE),i=r.objectStore("dump");i.clear().onsuccess=function(t){n.close(),e._e1()}},t.onerror=this._h7},_e1:function(){var e=this,t=this._currentSchema,n=t._a3,r=this._a3,i=0,s=!1,o,u,a=function(){var t=e._i3();t.onsuccess=function(e){u=e.target.result;var t=u.transaction([n],MSQTA._ss.READ_ONLY),r=t.objectStore(n);r.openCursor().onsuccess=f},t.onerror=this._h7},f=function(e){var t=e.target.result;t?s?(l(t.value),s=!1,u.close()):i===0?(l(t.value),i++,u.close()):(t.advance(i),i++,s=!0):(u.close(),h())},l=function(e){var t=MSQTA._rr.open("__msqta__",1);t.onsuccess=function(t){o=t.target.result;var n=o.transaction(["dump"],MSQTA._ss.READ_WRITE),r=n.objectStore("dump");r.add(e,i).onsuccess=c},t.onerror=this._h7},c=function(e){o.close(),a()},h=function(){e._e2(e._e3)};a()},_e2:function(e){var t=this,n=this._currentSchema,r=n._a3,i=this._a3,s=this._i2();s.onupgradeneeded=function(e){var n=e.target.result;n.deleteObjectStore(r),t._h8(n)},s.onsuccess=function(n){var r=n.target.result;r.close(),t._i1(e,t)},s.onerror=this._h7},_e3:function(){var e=this,t=this._currentSchema,n=t._a3,r=t._a4,i=this._a3,s,o,u=!1,a=0,f=function(){var e=MSQTA._rr.open("__msqta__",1);e.onsuccess=function(e){s=e.target.result;var t=s.transaction(["dump"],MSQTA._ss.READ_ONLY),n=t.objectStore("dump");n.openCursor().onsuccess=l},e.onerror=this._h7},l=function(e){var t=e.target.result;t?u?(c(t.value),u=!1,s.close()):a===0?(c(t.value),a++,s.close()):(t.advance(a),a++,u=!0):(s.close(),p())},c=function(t){var i=e._i3();i.onsuccess=function(e){o=e.target.result;var i=o.transaction([n],MSQTA._ss.READ_WRITE),s=i.objectStore(n),u,a,f;for(u in t)a=r[u],a?t[u]=a.cc(t[u],a.bb):delete t[u];f=s.put(t),f.onsuccess=h,f.onerror=h},i.onerror=this._h7},h=function(e){o.close(),f()},p=function(){e._e4()};f()},_e4:function(){var e=this,t=this._a3,n;n=MSQTA._rr.open("__msqta__",1),n.onsuccess=function(t){var n=t.target.result,r=n.transaction(["dump"],MSQTA._ss.READ_WRITE),i=r.objectStore("dump");i.clear().onsuccess=function(t){n.close(),e._e5()}},n.onerror=this._h7},_e5:function(){var e=this,t=this._a3,n=this._currentSchema,r=n._a3,i;i=MSQTA._rr.open("__msqta__",1),i.onsuccess=function(n){var r=n.target.result,i=r.transaction(["databases"],MSQTA._ss.READ_WRITE),s=i.objectStore("databases");s.index("name").get(t).onsuccess=function(t){var n=t.target.result,i;i=e._h6(s,n),i.onsuccess=function(t){r.close(),e._e7()}}},i.onerror=this._h7},_e6:function(){var e=this,t=this._a3,n=this._currentSchema,r=n._a3,i;i=this._i3(),i.onsuccess=function(t){var n=t.target.result,i=n.transaction([r],MSQTA._ss.READ_WRITE),s=i.objectStore(r);s.clear().onsuccess=function(t){e._e7()}},i.onerror=this._h7},_e7:function(){this._h9()},_h7:function(){this._h9(!1)},_h8:function(e){var t=this._currentSchema,n=t._a4,r=t._a3,i=t._a7,s,o,u,a;a=e.createObjectStore(r,{keyPath:i,autoIncrement:!0});for(s in n)o=n[s],o.index&&(u=o.unique,a.createIndex(s,s,u?{unique:!0}:{}))},_h9:function(e){var t=this._currentSchema,n=t._zz,r=t._a1;n.call(r,typeof e=="undefined"?!0:e),delete t._zz,delete t._a1,delete this._currentSchema,this._b8()},_b9:function(){this._xx=!1},_i1:function(e,t){var n=this,r=this._a3,i=this._currentBranch,s;s=MSQTA._rr.open("__msqta__",1),s.onsuccess=function(n){var s=n.target.result,o=s.transaction(["databases"],MSQTA._ss.READ_WRITE),u=o.objectStore("databases");u.index("name").get(r).onsuccess=function(n){var r=n.target.result;r.branch=i,u.put(r),s.close(),e&&e.call(t||window)}}},_i2:function(){var e=this._a3,t=this._currentBranch+1;return this._currentBranch=t,MSQTA._rr.open(e,t)},_i3:function(){var e=this._a3,t=this._currentBranch;return MSQTA._rr.open(e,t)},_i4:function(e){e.callback||(e.callback=MSQTA._ii.b),e.context||(e.context=window),this._uu.push(e);if(this._b2)return;this._b2=!0,this._i5()},_i5:function(){var e=this,t=this._uu.shift(),n=this._a3,r=t.schema,i=t.type,s;i==="destroy"?this._f1(t):(s=this._i3(),s.onsuccess=function(n){var i=n.target.result,s=t.type,o=i.transaction([r],MSQTA._ss.READ_WRITE);objectStore=o.objectStore(r),t.objectStore=objectStore,t.database=i,e["_"+s](t)})},_c8:function(){this._b2=!1,this._uu.length&&this._i5()},_i6:function(e,t){e.database.close(),e.callback.call(e.context,t),this._c8()},_put:function(e){var t=this,n=e.objectStore,r=e.data,i=0,s=r.length,o=function(n){i===s?t._i6(e,n):(u(),i++)},u=function(){var e=r[i],t=n.add(e);t.onsuccess=function(e){o(e.target.result)},t.onerror=function(e){o(!1)}};o()},_set:function(e){var t=this,n=e.objectStore,r=e.data,i=e.indexes,s=e.primaryKey,o=0,u=0,a=r.length,f=function(){u===a?t._i6(e,o):(l(),u++)},l=function(){var e=r[u],t=e.data,i=e.target,a=i[s],l,c=Object.keys(i).length;a?n.get(a).onsuccess=function(e){var r=e.target.result,i;if(r){for(l in t)r[l]=t[l];i=n.put(r),i.onsuccess=function(e){e.target.result&&o++,f()},i.onerror=function(e){f(!1)}}else f()}:n.openCursor().onsuccess=function(e){var n=e.target.result;if(n){var r=n.value,s=0,u;for(l in i)r[l]===i[l]&&s++;if(s===c){for(l in t)r[l]=t[l];u=n.update(r),u.onsuccess=function(e){e.target.result&&o++,n.continue()},u.onerror=function(e){n.continue()}}else n.continue()}else f()}};f()},_del:function(e){var t=this,n=e.objectStore,r=e.data,i=e.primaryKey,s=0,o=0,u=r.length,a=function(){o===u?t._i6(e,s):(f(),o++)},f=function(){var e=r[o];n.delete(e[i]).onsuccess=function(e){e.target.result&&s++,a()}};a()},_empty:function(e){var t=this,n,r=e.objectStore;r.count().onsuccess=function(i){n=i.target.result,r.clear().onsuccess=function(r){t._i6(e,n)}}},_f1:function(e){var t=this,n=e.schema,r=this._i2();r.onupgradeneeded=function(e){var t=e.target.result;t.deleteObjectStore(n)},r.onsuccess=function(n){var r=n.target.result;r.close(),t._i7(e)}},_i7:function(e){var t=this,n=this._a3,r=e.schema,i=this._vv[r],s=MSQTA._rr.open("__msqta__",1);s.onsuccess=function(s){var o=s.target.result,u=o.transaction(["databases"],MSQTA._ss.READ_WRITE),a=u.objectStore("databases");a.index("name").get(n).onsuccess=function(n){var s=n.target.result;delete s.schemas[r],a.put(s).onsuccess=function(n){t._i1(function(){e.database=o,delete t._vv[r],MSQTA._ii.k(i),this._i6(e,!0)},t)}}}},batch:function(e,t,n){var r=this._a3,i;if(!(e instanceof Array)||!e.length)throw Error("MSQTA-ORM!");typeof t!="function"&&(t=MSQTA._ii.b),typeof n!="object"&&(n=window),i={data:e,callback:t,context:n};if(this._b1){this._ww.push(i);return}this._b1=!0,this._c9(i)},_c9:function(e){var t=e.data,n=["set","put","del"],r=0,i=t.length,s,o,u,a;for(;r<i;r++){o=t[r],u=o.schema;if(!(u instanceof MSQTA._a9))throw Error("MSQTA-ORM!");a=o.type.toLowerCase();if(n.indexOf(a)===-1)throw Error("MSQTA-ORM!");s=u[a](o.data),s.callback=MSQTA._ii.b,s.context=window,this._uu.push(s)}s=this._uu[this._uu.length-1],s.callback=e.callback,s.context=e.context,this._b1=!1,this._b2||this._c8()},destroy:function(e,t){typeof e!="function"&&(e=MSQTA._ii.a),this._c2(e,t)}},MSQTA._a9.IndexedDB={_d3:function(){var e=this._a2,t=this._a4,n,r,i={};for(n in t)r=t[n],this._r(n),i[n]={type:r.type,index:r.index,unique:r.unique};this._b3=i,e._b7(this)},get:function(e,t,n){var r=this._a2,i=r._a3,s=this._a4,o,u={},a=this._a3;if(!e)throw Error("MSQTA-ORM!");for(o in s)u[o]=this._q(o,e);var f=function(e,t,n){for(var r in e)if(e[r]===n[r])return!0;return!1};this._i8({callback:f,comparator:u,fields:null},t,n)},getAll:function(e,t){var n=this._a2,r=n._a3,i=this._a3,s=function(){return!0};this._i8({callback:s,comparator:null,fields:null},e,t)},getWithLike:function(e,t,n,r){var i=this._a2,s=i._a3,o=this._a4,u=this._a3,a,f,l,c,h;if(typeof t!="object")throw Error("MSQTA-ORM!");c=Object.keys(t)[0],h=t[c];if(!c||!h)throw Error("MSQTA-ORM!");c==="both"?h=new RegExp(h,"i"):c==="start"?h=new RegExp("^"+h,"i"):c==="end"&&(h=new RegExp(h+"$","i")),e instanceof Array||(e=[e]);for(a=0,f=e.length;a<f;a++){l=e[a];if(!o[l])throw Error("MSQTA-ORM!")}var p=function(e,t,n){var r,i=0,s=t.length;for(;i<s;i++){r=t[i];if(n.test(e[r]))return!0}return!1};this._i8({callback:p,comparator:h,fields:e},n,r)},getByCallback:function(e,t,n){var r=this._a2,i=r._a3,s=this._a3;if(typeof e!="function")throw Error("MSQTA-ORM!");this._i8({callback:e,comparator:null,fields:null},t,n)},_i8:function(e,t,n){var r={filterData:e,callback:t||MSQTA._ii.b,context:n||window,self:this};(function(e){var t=e.self,n=t._a2,r=n._i3(),i,s=n._a3,o=t._a3,u=e.filterData,a=u.callback,f=u.comparator,l=u.fields,c=[];r.onsuccess=function(t){var n=t.target.result,r=n.transaction([o],MSQTA._ss.READ_ONLY);objectStore=r.objectStore(o),i=n,objectStore.openCursor().onsuccess=function(t){var n=t.target.result,r;n?(r=n.value,a(r,l,f)&&c.push(r),n.continue()):(i.close(),e.callback.call(e.context,c))}}})(r)},getByIndex:function(e,t,n,r){var i=this._a2,s=i._a3,o=this._a3,u={},a=[],f,l,c,h,p;if(this._a7!==e&&this._a5.indexOf(e)===-1)throw Error("MSQTA-ORM!");this._a7===e?u.pk=e:u.index=e;if(!t)throw Error("MSQTA-ORM!");t instanceof Array||(t=[t]);if(t.length===1)u.keyRange=MSQTA._tt.only(this._q(e,t[0])),this._i9(u,n,r);else{for(h=0,p=t.length;h<p;h++)l=t[h],c=this._q(e,l),a.push(c);f=function(e,t,n){for(var r=0,i=t.length;r<i;r++)if(t[r]===e[n])return!0;return!1},this._i8({callback:f,comparator:u.pk||u.index,fields:a},n,r)}},getByIndexWithRange:function(e,t,n,r){var i=this._a2,s=i._a3,o=this._a3,u=this._a4,a=/^(?:>|<|>=|<=|=)$/,f,l={},c={},h,p,d=u[e],v,m;if(this._a7!==e&&this._a5.indexOf(e)===-1)throw Error("MSQTA-ORM!");this._a7===e?l.pk=e:l.index=e,v=t["="],v&&d.ee&&(t={">=":v,"<=":v});for(f in t){if(!a.test(f))throw Error("MSQTA-ORM!");v=t[f],m=this._q(e,v);if(!m&&m!==d.bb)throw Error("MSQTA-ORM!");c[f]=m}h=Object.keys(c).length;if(h===2)try{c[">"]&&c["<"]?p=MSQTA._tt.bound(c[">"],c["<"],!0,!0):c[">="]&&c["<="]?p=MSQTA._tt.bound(c[">="],c["<="]):c[">"]&&c["<="]?p=MSQTA._tt.bound(c[">"],c["<="],!0,!1):p=MSQTA._tt.bound(c[">="],c["<"],!1,!0)}catch(g){throw Error("MSQTA-ORM!")}else h===1&&(c[">"]?p=MSQTA._tt.lowerBound(c[">"],!0):c[">="]?p=MSQTA._tt.lowerBound(c[">="]):c["<"]?p=MSQTA._tt.upperBound(c["<"],!0):c["<="]?p=MSQTA._tt.upperBound(c["<="]):p=MSQTA._tt.only(c["="]));if(!p)throw Error("MSQTA-ORM!");l.keyRange=p,this._i9(l,n,r)},_i9:function(e,t,n){var r={range:e,callback:t||MSQTA._ii.b,context:n||window,self:this};(function(e){var t=e.self,n=t._a2,r=e.range,i=r.pk,s=r.index,o=r.keyRange,u=n._i3(),a,f=n._a3,l=t._a3,c=[],h=function(t){var n=t.target.result;n?(c.push(n.value),n.continue()):(a.close(),e.callback.call(e.context,c))};u.onsuccess=function(e){var t=e.target.result,n=t.transaction([l],MSQTA._ss.READ_ONLY);objectStore=n.objectStore(l),a=t,i?objectStore.openCursor(o).onsuccess=h:objectStore.index(s).openCursor(o).onsuccess=h}})(r)},put:function(e,t,n){var r=this._a2,i=r._a3,s=this._a8,o,u=this._a7,a=this._a3,f,l,c,h,p=s.length,d;!(e instanceof Array)&&typeof e=="object"&&(e=[e]);for(l=0,c=e.length;l<c;l++){f=e[l];for(h=0;h<p;h++)o=s[h],f[o]=this._q(o,f[o]);f[u]<=0&&delete f[u]}d={type:"put",schema:a,primaryKey:u,data:e,callback:t,context:n};if(r._b1)return d;r._i4(d)},set:function(e,t,n){var r=this._a2,i=this._a3,s=this._a4,o=r._a3,u,a,f,l,c,h,p={},d={},v=[],m,g,y;if(!e||typeof e!="object")throw Error("MSQTA-ORM!");e instanceof Array||(e=[e]);for(m=0,g=e.length;m<g;m++){a=e[m];if(!a.data||typeof a.data!="object"||!Object.keys(a.data).length)throw Error("MSQTA-ORM!");if(a.target){if(typeof a.target!="object"||!Object.keys(a.target).length)throw Error("MSQTA-ORM!")}else a.target=[];f=a.target;for(c in f){h=f[c],parsedValue=this._q(c,h);if(!parsedValue&&parsedValue!==s[c].bb)throw Error("MSQTA-ORM!");p[c]=parsedValue}l=a.data;for(c in l){h=l[c],parsedValue=this._q(c,h);if(!parsedValue&&parsedValue!==s[c].bb)throw Error("MSQTA-ORM!");d[c]=parsedValue}v.push({data:d,target:p}),d={},p={}}y={type:"set",schema:i,indexes:this._a5,primaryKey:this._a7,data:v,callback:t,context:n};if(r._b1)return y;r._i4(y)},del:function(e,t,n){var r=this._a2,i=r._a3,s=this._a7,o=this._a3,u,a,f,l=[],c,h,p;if(!s)throw Error("MSQTA-ORM!");if(!e)throw Error("MSQTA-ORM!");e instanceof Array||(e=[e]);for(c=0,h=e.length;c<h;c++){u=e[c],a=this._q(s,u);if(!a)throw Error("MSQTA-ORM!");f={},f[s]=a,l.push(f)}p={type:"del",schema:o,primaryKey:s,data:l,callback:t,context:n};if(r._b1)return p;r._i4(p)},destroy:function(e,t){var n=this._a2,r=n._a3,i=this._a3;n._i4({type:"destroy",schema:i,callback:e,context:t})},empty:function(e,t){var n=this._a2,r=n._a3,i=this._a3;n._i4({type:"empty",schema:i,callback:e,context:t})}},MSQTA._a2.WebSQL={Schema:function(e){return MSQTA._ii.n({ORM:this.constructor._a2,schemaPrototype:MSQTA._a9.WebSQL,schemaDefinition:e,implementation:"webSQL",args:arguments})},_b5:function(){(function(e){e._f2=window.openDatabase("__msqta__",1,"",MSQTA._ii.ll),e._f2.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS databases( id INTEGER PRIMARY KEY, name TEXT UNIQUE, schemas TEXT )"),t.executeSql('SELECT * FROM databases WHERE name = "'+e._a3+'"',[],function(t,n){e._b6(n)})})})(this)},_b6:function(e){var t=e.rows;this._f3=t.length?JSON.parse(t.item(0).schemas):{},this._f4=[],this._f5=[],this._f6=window.openDatabase(this._a3,1,"",MSQTA._ii.ll),this._zz.call(this.initContext,!0),this._b8()},_b7:function(e){this._yy.push(e),this._xx||(this._xx=!0,this._b8())},_b8:function(){var e=this,t=this._a3;this._yy.length?this._yy.shift()._d4():this._b9()},_b9:function(){this._xx=!1},_c1:function(e,t,n){var r=this,i=this._a3,s=this._f3;this._f2.transaction(function(r){r.executeSql('REPLACE INTO databases( name, schemas ) VALUES( "'+i+'", '+"'"+JSON.stringify(s)+"'"+")",[],function(){e.call(t,n)})})},_c2:function(e,t){this.destroy(e,t)},_c3:function(e,t){var n=e._a3;delete this._vv[n],delete this._f3[n],MSQTA._ii.k(e),this._c1(t.g2,t.g3,!0)},_c4:function(e){this._c7(!1)},_c5:function(e){var t=e.g2,n=e.g3;if(t&&typeof t!="function")throw Error("MSQTA-ORM!");t||(e.g2=MSQTA._ii.b);if(n&&typeof n!="object")throw Error("MSQTA-ORM!");n||(e.g3=window);if(this._b2){e.h4?this._f5.push(e):this._uu.push(e);return}this._b2=!0,this._c6(e)},_c6:function(e){this._f7=e;var t=this,n=0,r=e.f8;r instanceof Array||(r=[r]);var i=e.g1?function(e,t){n+=t.rowsAffected}:MSQTA._ii.a,s=function(r,i){e.g1?e.returnValue=i.rowsAffected+n:e.g5?e.returnValue=i.insertId:e.g4&&(e.returnValue=i.rowsAffected),t._c7(i)},o=function(e,n){t._c4(n)};this._f6.transaction(function(t){var n,u=r.length;while(u--)n=r.shift(),t.executeSql(n,e.f9?e.f9.shift():[],u?i:s,o)})},_c7:function(e){queryData=this._f7,this._b2=!1,e||(queryData.returnValue=!1),queryData.callback&&queryData.context?queryData.callback.call(queryData.context,e,queryData):queryData.g2.call(queryData.g3,queryData.returnValue),this._c8()},_c8:function(){this._b2||(this._f5.length?this._c5(this._f5.shift()):this._uu.length&&!this._xx&&this._c5(this._uu.shift()))},batch:function(e,t,n){var r=this._a3,i;if(!(e instanceof Array)||!e.length)throw Error("MSQTA-ORM!");typeof t!="function"&&(t=MSQTA._ii.b),typeof n!="object"&&(n=window),i={data:e,callback:t,context:n};if(this._b1){this._ww.push(i);return}this._b1=!0,this._c9(i)},_c9:function(e){var t=e.data,n=["set","put","del"],r,i,s,o=0,u=t.length;for(;o<u;o++){r=t[o],i=r.schema;if(!(i instanceof MSQTA._a9))throw Error("MSQTA-ORM!");s=r.type.toLowerCase();if(n.indexOf(s)===-1)throw Error("MSQTA-ORM!");this._uu.push(i[s](r.data))}var a=this._uu[this._uu.length-1];a.g2=e.callback,a.g3=e.context,this._b1=!1,this._c8(),this._ww.length&&this._c9(this._ww.shift())},destroy:function(e,t){typeof e!="function"&&(e=MSQTA._ii.a),e.call(t||window,!1)},_d1:function(e){return this._f4.push(e),this._f4.length-0},_d2:function(e){this._f4.splice(e,1)}},MSQTA._a9.WebSQL={_d3:function(){var e=this._a4,t,n,r=this._a2,i=r._a3,s=this._a3,o=[],u=this._a7,a,f={},l,c,h,p,d={};for(n in e)t=e[n],a=[],u===n?a.push("PRIMARY KEY"):(l=t.index,c=t.unique,l&&c?f[n]=this._d5(s,n):c?a.push("UNIQUE"):l&&(f[n]=this._d6(s,n))),this._r(n),d[n]={type:t.type,index:t.index,unique:t.unique},o.push(n+" "+e[n].gg+(a.length?" "+a.join(" "):""));h='CREATE TABLE "'+s+'" ( '+o.join(", ")+" )",this._g6=h,this._b3=d,this._g7=f,this._g8=[],r._b7(this)},_d4:function(){var e=this._a2,t=e._a3,n=this._a3,r=this._g6,i,s,o;this.forceDestroy?(this._h3=!0,i='--MSQTA-ORM: "forceDestroy" flag detected: destroying the "'+n+'" schema from the "'+t+'" database, then it will recreate again\n	DROP TABLE IF EXISTS '+n,e._c5({f8:[i,r],context:this,callback:this._e4,h4:!0})):(o={fields:this._b3,primaryKey:this._a7},s=e._f3[n],s?this._d7(s,o):(e._f3[n]=o,this._a2._c1(this._d8,this)))},_d5:function(e,t){return"CREATE UNIQUE INDEX "+e+"_"+t+" ON "+e+" ( "+t+" )"},_d6:function(e,t){return"CREATE INDEX "+e+"_"+t+" ON "+e+" ( "+t+" )"},_d7:function(e,t){var n=this._a2,r=n._a3,i=this._a3,s=!1,o=e.fields,u=t.fields,a,f,l,c={},h=this._g7;for(l in o){a=o[l],f=u[l];if(!f||a.type!==f.type){s=!0;break}a.index&&a.unique?c[l]=this._d5(i,l):a.index&&(c[l]=this._d6(i,l))}var p=e.primaryKey,d=t.primaryKey;!s&&(p&&(!d||p!==d)||!p&&d)&&(s=!0);if(s)n._f3[i]=t,this._a2._c1(this._d9,this);else{var v,m,g=[];for(l in c)v=c[l],m=h[l],(!m||m&&v!==m)&&g.push(l);g.length?(this._g8=g,n._f3[i]=t,this._a2._c1(this._e4,this)):this._e6()}},_d8:function(){var e=this._a2,t=this._a3,n=e._a3,r=this._g6;e._c5({f8:[r],context:this,callback:this._e4,h4:!0})},_d9:function(){var e=this._a2,t=this._g6,n=this._a3,r=n+ +(new Date),i=t.replace('CREATE TABLE "'+n+'"','CREATE TABLE "'+r+'"');this._g9=0,this._h1=r,e._c5({f8:[i],context:this,callback:this._e1,h4:!0})},_e1:function(){var e=this._a2,t=this._a3,n=this._h1,r=this._g9,i,s=this._a4;this._h2=e._d1("DROP TABLE "+n),i="SELECT * FROM "+t+" LIMIT "+r+", 500",e._c5({f8:[i],context:this,callback:this._e2,h4:!0})},_e2:function(e){var t=this._a2,n=this._a4,r=this._a3,i=this._h1,s=e.rows,o,u,a,f=[],l=[],c=[],h=[],p,d;if(!e)throw Error("MSQTA-ORM!");if(!s.length){this._e3();return}o=s.item(0);for(u in o)n[u]&&f.push(u);for(u in n)a=n[u],f.indexOf(u)===-1&&(f.push(u),c.push(a.bb));for(p=0,d=s.length;p<d;p++){o=s.item(p);for(u in o)a=n[u],a&&(a.hh?l.push("'"+o[u]+"'"):l.push(a.cc(o[u],a.bb)));h.push("INSERT INTO "+i+" ( "+f.join(", ")+" ) VALUES ( "+l.concat(c).join(", ")+" )"),l=[]}d===500?(this._g9+=500,t._c5({f8:h,context:this,callback:this._e1,h4:!0})):t._c5({f8:h,context:this,callback:this._e3,h4:!0})},_e3:function(){var e=this._a2,t=this._a3,n="DROP TABLE "+t,r=this._h1,i="ALTER TABLE "+r+" RENAME TO "+t;this._h3=!0,e._c5({f8:[n,i],context:this,callback:this._e4,h4:!0})},_e4:function(){var e=this._a2,t=e._a3,n=[],r=this._g8,i,s=this._g7;if(!this._h3)while(r.length)n.push("DROP INDEX "+t+"_"+r.shift());else delete this._h3;for(i in s)n.push(s[i]);n.length?e._c5({f8:n,context:this,callback:this._e5,h4:!0}):this._e5()},_e5:function(){var e=this._a2;e._d2(this._h2),delete this._h1,delete this._g9,delete this._h2,delete this._g8,this.forceEmpty?this._e7():this._e6()},_e6:function(){var e=this._a2;delete this._g6,delete this._g7,this._zz.call(this._a1,!0),delete this._zz,delete this._a1,e._b8()},_e7:function(){var e=this._a2,t=e._a3,n=this._a3,r='--MSQTA-ORM: "forceEmpty" flag detected: emptying the "'+n+'" schema from the "'+t+'" database\n	DELETE FROM '+n;e._c5({f8:[r],context:this,callback:this._e6,h4:!0})},get:function(e,t,n){var r=this._a2,i=this._a4,s,o=r._a3,u=this._a3,a,f=[],l=[];if(!e)throw Error("MSQTA-ORM!");for(s in i)f.push(s+" = ?"),l.push(this._q(s,e));a="SELECT * FROM "+u+" WHERE "+f.join(" OR "),r._c5({f8:a,f9:[l],context:this,callback:this._e9,g2:t,g3:n})},getByCallback:function(e,t,n){var r=this._a2,i=this._a4,s,o=this._a3,u;if(typeof e!="function")throw Error("MSQTA-ORM!");u="SELECT * FROM "+o,r._c5({f8:u,context:this,callback:this._e8,g2:t,g3:n,filterCallback:e})},_e8:function(e,t){var n=this._a4,r=e.rows,i=0,s=r.length,o,u,a=t.filterCallback,f,l=[];for(;i<s;i++){o=r.item(i),f={};for(u in o)f[u]=n[u].dd(o[u]);a(f)&&l.push(f)}t.g2.call(t.g3,l)},getByIndex:function(e,t,n,r){var i=this._a2,s=i._a3,o=this._a3,u,a=[],f=[],l,c,h,p;if(this._a7!==e&&this._a5.indexOf(e)===-1)throw Error("MSQTA-ORM!");if(!t)throw Error("MSQTA-ORM!");t instanceof Array||(t=[t]);for(h=0,p=t.length;h<p;h++)l=t[h],c=this._q(e,l),a.push(e+" = ?"),f.push(c);u="SELECT * FROM "+o+(a.length?" WHERE "+a.join(" OR "):""),i._c5({f8:u,f9:[f],context:this,callback:this._e9,g2:n,g3:r})},getByIndexWithRange:function(e,t,n,r){var i=this._a2,s=i._a3,o=this._a3,u=this._a4,a=/^(?:>|<|>=|<=|=)$/,f,l=[],c,h,p=[],d;if(this._a7!==e&&this._a5.indexOf(e)===-1)throw Error("MSQTA-ORM!");for(f in t){if(!a.test(f))throw Error("MSQTA-ORM!");c=t[f],h=this._q(e,c);if(!h&&h!==u[e].bb)throw Error("MSQTA-ORM!");l.push(e+" "+f+" ?"),p.push(h)}if(!l.length)throw Error("MSQTA-ORM!");d="SELECT * FROM "+o+" WHERE "+l.join(" AND "),i._c5({f8:d,f9:[p],context:this,callback:this._e9,g2:n,g3:r})},getAll:function(e,t){var n=this._a2,r=this._a3,i="SELECT * FROM "+r;n._c5({f8:i,context:this,callback:this._e9,g2:e,g3:t})},getWithLike:function(e,t,n,r){var i=this._a2,s=i._a3,o=this._a4,u=this._a3,a,f,l,c,h,p=[],d,v=[];if(typeof t!="object")throw Error("MSQTA-ORM!");c=Object.keys(t)[0],h=t[c];if(!c||!h)throw Error("MSQTA-ORM!");c==="both"?h="%"+h+"%":c==="start"?h+="%":c==="end"&&(h="%"+h),e instanceof Array||(e=[e]);for(a=0,f=e.length;a<f;a++){l=e[a];if(!o[l])throw Error("MSQTA-ORM!");v.push(l+" LIKE ?"),p.push(h)}d="SELECT * FROM "+u+" WHERE "+v.join(" OR "),i._c5({f8:d,f9:[p],context:this,callback:this._e9,g2:n,g3:r})},_e9:function(e,t){var n=this._a4,r=e.rows,i=0,s=r.length,o,u,a,f=[];for(;i<s;i++){o=r.item(i),a={};for(u in o)a[u]=n[u].dd(o[u]);f.push(a)}t.g2.call(t.g3,f)},put:function(e,t,n){var r=this._a2,i=r._a3,s=this._a8,o,u=this._a3,a,f=[],l,c,h=[],p,d,v,m,g=s.length,y;!(e instanceof Array)&&typeof e=="object"&&(e=[e]);for(d=0,v=e.length;d<v;d++){p=e[d],a=[],l=[],c=[];for(m=0;m<g;m++)o=s[m],a.push(o),l.push(this._q(o,p[o])),c.push("?");f.push(l),h.push("INSERT INTO "+u+" ( "+a.join(", ")+" ) "+"VALUES ( "+c.join(" , ")+" )")}y={f8:h,f9:f,g2:t,g3:n,g5:!0};if(r._b1)return y;r._c5(y)},set:function(e,t,n){var r=this._a2,i=this._a3,s=r._a3,o=this._a4,u,a,f,l,c,h,p,d,v=[],m,g=[],y,b,w;if(!e||typeof e!="object")throw Error("MSQTA-ORM!");e instanceof Array||(e=[e]);for(y=0,b=e.length;y<b;y++){a=e[y],m=[],d=[],p=[];if(!a.data||typeof a.data!="object"||!Object.keys(a.data).length)throw Error("MSQTA-ORM!");if(a.target){if(typeof a.target!="object"||!Object.keys(a.target).length)throw Error("MSQTA-ORM!")}else a.target=[];l=a.data;for(c in l){h=l[c],parsedValue=this._q(c,h);if(!parsedValue&&parsedValue!==o[c].bb)throw Error("MSQTA-ORM!");d.push(c+" = ?"),m.push(parsedValue)}f=a.target;for(c in f){h=f[c],parsedValue=this._q(c,h);if(!parsedValue&&parsedValue!==o[c].bb)throw Error("MSQTA-ORM!");p.push(c+" = ?"),m.push(parsedValue)}g.push("UPDATE "+i+" SET "+d.join(", ")+(p.length?" WHERE "+p.join(" AND "):"")),v.push(m)}w={f8:g,f9:v,g1:!0,g2:t,g3:n};if(r._b1)return w;r._c5(w)},del:function(e,t,n){var r=this._a2,i=r._a3,s=this._a7,o=this._a3,u,a,f,l=[],c,h,p;if(!s)throw Error("MSQTA-ORM!");if(!e)throw Error("MSQTA-ORM!");e instanceof Array||(e=[e]);for(c=0,h=e.length;c<h;c++){u=e[c],a=this._q(s,u);if(!a)throw Error("MSQTA-ORM!");l.push(s+" = "+a)}f="DELETE FROM "+o+(l.length?" WHERE "+l.join(" OR "):""),p={f8:f,g4:!0,g2:t,g3:n};if(r._b1)return p;r._c5(p)},destroy:function(e,t){var n=this._a2,r=this._a3,i="DROP TABLE "+r;n._c5({callback:this._f1,context:this,f8:i,g2:e,g3:t})},_f1:function(e,t){var n=this._a2;e&&n._c3(this,t)},empty:function(e,t){var n=this._a2,r=this._a3,i="DELETE FROM "+r;n._c5({f8:i,g4:!0,g2:e,g3:t})}}